<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>Smalltalk76/Panes-and-Menus.st</title>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">&rsquo;From Smalltalk 5.5k XM November 24 on 22 November 1980 at 2:57:08 am.&rsquo;<br></span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">"CodePane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;CodePane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Window<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;pared class selector selectorPane scrollBar&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;editmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a Window for editing a paragraph which may include Smalltalk source code.  My selectorPane (not necessarily of class SelectorPane, and possibly even myself) compiles and doits for me.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">class: class selector: selector para: para</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu &larr; Menu new string:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">&rsquo;again<br>copy<br>cut<br>paste<br>doit<br>compile<br>undo<br>cancel<br>align&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">from: selectorPane</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">init</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">showing: paragraph<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pared &larr; ParagraphEditor new para: paragraph asParagraph frame: nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pared formerly: false; fixframe: frame.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self windowenter.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar &larr; ([scrollBar≡nil⇒ [ScrollBar new] scrollBar]) on: frame from: pared]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pared unselect. selectorPane &larr; pared &larr; nil. scrollBar close]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">doit </span><span style="font: 10pt serif">| s val d [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">d &larr; [user leftShiftKey⇒ [mem◦067] false].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[d⇒ [mem◦067 &larr; 58]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar hide.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">do automatic selection (ESC) on empty selections</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(s &larr; pared selectRange) empty⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pared unselect; fintype; complement.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; pared selectRange]].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">val &larr; selectorPane execute: pared selectionAsStream for: self. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[val≡nil or⦂ s ≠ pared selectRange⇒ ["</span><span style="font: italic 10pt serif">result is nil or error occurred</span><span style="font: 10pt serif">"]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">automatically paste result</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s&larr; s stop+1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pared Scrap &larr; [(String new: 100) asStream<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">space; print: val; contents asParagraph];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selectRange: (s to: s); paste].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">d⇒ [mem◦067 &larr; d]<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">eachtime </span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user kbck⇒ [⇑self kbd]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame has: user mp⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user anybug⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug⇒ [⇑self redbug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user yellowbug⇒ [⇑self yellowbug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user bluebug⇒ [⇑false]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user anykeys⇒ [⇑self keyset]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self outside]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">enter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[scrollBar show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">frame &larr; frame<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Change my frame and that of my pared (if any)."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pared≡nil⇒ [] pared frame &larr; frame.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar on: frame from: pared]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hardcopy: pf </span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"if this is just part of a CodeWindow, then print entire Paragraph with no frame.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">unfortunately, the test for this is a kludge. otherwise, print clipped"<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selectorPane ≡ self⇒ [(PressPrinter init) press: pf; print: pared contents]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame hardcopy: pf thickness: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pared hardcopy: pf]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">kbd<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pared typing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">keyset<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑pared keyset]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">leave<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[scrollBar hide]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">outline<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[frame outline: 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">outside<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑scrollBar startup]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">picked<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑frame has: user mp]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">redbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑pared selecting]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">show<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[frame outline. pared show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">windowenter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self outline. pared enter]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">windowleave<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pared≡nil⇒[] pared leave]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=5⇒[self doit];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒[scrollBar hidewhile⦂ [pared again]];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒[pared copy];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒[pared cut];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒[pared paste];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=6⇒[pared formerly⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[scrollBar hidewhile⦂ [selectorPane compile: pared contents⇒ [pared formerly: false]]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">  frame flash];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=7⇒[pared undo];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=8⇒[pared formerly⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pared Deletion &larr; pared contents.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar hidewhile⦂ [self showing: pared formerly]] frame flash];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=9⇒[pared realign]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Browse/Notify protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"as my own selectorPane"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑self compile: parag in: class under: &rsquo;As yet unclassified&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag in: defaultClass under: category<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Generator new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">compile: parag<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">in: [class≡nil⇒ [defaultClass] class]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">under: category<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">notifying: self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">contents<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑pared contents]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dirty<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pared formerly⇒ [⇑frame] ⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">execute: parseStream for: codePane</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"as my own selectorPane"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑self execute: parseStream in: false to: nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">execute: parseStream in: context to: receiver<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Generator new evaluate: parseStream in: context to: receiver notifying: self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">formerly: oldpara </span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"should not be called before &rsquo;showing:&rsquo;"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pared formerly: oldpara]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">interactive<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑true]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">notify: errorString at: position in: stream<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pared<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">fintype;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selectRange: (position to: position);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">replace: (&rsquo;➲&rsquo; + errorString + &rsquo;➲.&rsquo;) asParagraph;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selectAndScroll.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">oldContents<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑pared formerly]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">reflects: selection  </span><span style="font: italic 10pt serif">"am I trying to show the code of selectorPaneⓢ selection?"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑class≡nil and⦂ selection&gt;0]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selectRange: r </span><span style="font: 10pt serif">[pared selectRange: r; selectAndScroll]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪CodePane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">CodePane classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"FilePane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;FilePane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: CodePane<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;file&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;editmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>As yet unclassified</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit </span><span style="font: 10pt serif">"FilePane classInit."</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu &larr; Menu new string:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">&rsquo;again<br>copy<br>cut<br>paste<br>doit<br>put<br>undo<br>get<br>align&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">file: file</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒[pared again];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒[pared copy];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒[pared cut];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒[pared paste];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=5⇒[self doit];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=6⇒[pared formerly⇒ [user displayoffwhile⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">file readwriteshorten; reset; append: pared contents; close.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pared formerly: false]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame flash];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=7⇒[pared undo];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=8⇒[user displayoffwhile⦂ [scrollBar hidewhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self showing: file contents asParagraph]]];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=9⇒[pared realign]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪FilePane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">FilePane classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"ListPane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;ListPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Textframe<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;list firstShown lastShown selection scrollBar&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>A list pane displays a vertical list of one-line items.  The list can be scrolled slow or fast, and any item can be selected.  When an item is selected (or deselected), a dependent pane can be told to display appropriate material.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">of: list </span><span style="font: 10pt serif">"Acquire the specified list and show me scrolled to the top"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[firstShown&larr; selection&larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self frame&larr; window.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fill; deselected]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">revise: newlist with: sel  </span><span style="font: 10pt serif">| changing<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Acquire newlist. Do not change firstShown. Select sel if in list."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[changing &larr; list≠newlist⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[list &larr; newlist.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">firstShown &larr; firstShown min: (<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">list length+2  - (window height-4/self lineheight) max: 0).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil ≠ para⇒ [para &larr; para asStream]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fill]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> selection&gt;0⇒ [changing &larr; list◦selection≠sel⇒ [self compselection]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> changing &larr; true].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">changing⇒ [selection &larr; ¬1. self select: (list find: sel)]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">select: lineNum </span><span style="font: 10pt serif">| oldSel<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Select my non-dummy displayed entry whose subscript is lineNum; highlight it; if it is different from selection, tell me to select.  If there is no such entry, set selection to 0 and if it wasnt 0 before, tell me to deselect."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">oldSel &larr; selection.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(1 max: firstShown) ≤ lineNum and⦂ lineNum ≤ (list length min: lastShown)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection &larr; lineNum. self compselection. oldSel≠selection⇒ [self selected]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; 0. oldSel≠selection⇒ [self deselected]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Pane protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close</span><span style="font: bold italic 10pt serif"> </span><span style="font: italic 10pt serif">"Zero my selection so it wont be grayed when I close.  Break cycles."</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection&larr;0. scrollBar close]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">eachtime<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[window has: user mp⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user kbck⇒[⇑self kbd]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user anybug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user redbug⇒[⇑self redbug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user yellowbug⇒[⇑self yellowbug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user bluebug⇒[⇑false]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user anykeys⇒[⇑self keyset]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self outside]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">enter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[scrollBar show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">firsttime<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[window has: user mp⇒[self enter]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">frame &larr; window </span><span style="font: italic 10pt serif">"(Re)initialize my window"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[para &larr; nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar &larr; ([scrollBar≡nil⇒ [ScrollBar new] scrollBar]) on: window from: self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hardcopy: pf </span><span style="font: 10pt serif">| t cr first last lasty lineNum parag left right lineheight [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">window hardcopy: pf thickness: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[para≡nil⇒ [self makeParagraph]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">parag &larr; para asParagraph.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; para asStream.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">last &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">cr &larr; 015.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">left &larr; frame minX.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">right &larr; window maxX.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">lasty &larr; frame minY.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">lineheight &larr; self lineheight.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ lineNum from: firstShown to: lastShown do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">first &larr; last.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(t skipTo: cr) or⦂ lineNum = lastShown⇒ [last &larr; t position]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;not enough lines&rsquo;].<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[lineNum = selection and⦂ selection &gt; 0⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"outline selection; complementing doesn&rsquo;t look good"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self selectionRect-(0⌾1) inset: 0⌾1) hardcopy: pf thickness: 1]].<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(parag copy: first+1 to: last-1) presson: pf in:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(pf transrect: (left ⌾ lasty rect: right ⌾ (lasty+lineheight+4))) style: style.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">lasty &larr; lasty + lineheight.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">kbd<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[window flash. user kbd.]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">keyset </span><span style="font: 10pt serif">| c<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"As long as any keyset keys are down, react to keys 2 and 8 down by scrolling up or down a line at a time.  If key 4 is down as well, scroll faster."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c &larr; user currentCursor.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self scrollControl⦂ [user keyset=6⇒[2]; =12⇒[¬2]; =2⇒[1]; =8⇒[¬1] 0].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">lasttime<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self leave]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">leave<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[scrollBar hide]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">outline<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[window outline: 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">outside </span><span style="font: 10pt serif">[⇑scrollBar startup]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">picked<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑window has: user mp]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">redbug </span><span style="font: 10pt serif">| newSel f</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"Deselect selection and select cursor item, if any"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[[f &larr; self locked⇒ []<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self compselection.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newSel &larr; (user mp y - window origin y)/self lineheight + firstShown.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor showwhile⦂ [self select: [newSel = selection⇒ [0] newSel]]].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ (user redbug and⦂ (window has: user mp)) do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f⇒ [f flash. self compselection; compselection]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">scrollPos<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[firstShown≡nil or⦂ list length=0⇒[⇑0.0]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑firstShown asFloat/list length]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">scrollTo: f | t</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self scrollControl⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[t&larr; (f*list length) asInteger - firstShown.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">t&lt;0⇒[firstShown&lt;0⇒[0] t]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">lastShown&gt;list length⇒[0] t]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">windowenter </span><span style="font: italic 10pt serif">"Refresh my image.  Reaffirm selection."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self outline; fill; select: selection.]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">windowleave<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self compselection; grayselection]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[window flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Subclass defaults</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselected </span><span style="font: italic 10pt serif">"I just lost my selection.  I dont care, but my subclasses might."</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dirty </span><span style="font: italic 10pt serif">"My subclasses may want to prohibit a change of selection"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">locked </span><span style="font: italic 10pt serif">"My subclasses may want to prohibit a change of selection"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑[selection=0⇒ [false] self dirty]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selected </span><span style="font: italic 10pt serif">"A new selection is highlighted.  I dont care, but my subclasses might"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Private</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compselection </span><span style="font: italic 10pt serif">"If I have a selection, complement its image."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection≠0⇒ [self selectionRect comp]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dummy<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑&rsquo;▱▱▱▱▱▱▱&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fill </span><span style="font: 10pt serif">[self makeParagraph; show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">grayselection<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection≠0⇒ [self selectionRect color: ltgray mode: oring]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">init<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self para: nil frame: nil.]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">makeParagraph </span><span style="font: 10pt serif">| i len s lines </span><span style="font: italic 10pt serif">"Given firstShown, compute lastShown."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">len &larr; list length.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">lastShown &larr; firstShown-1 + (lines &larr; window height-4/self lineheight)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">min: 1+len.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self locked⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[i &larr; (selection-lastShown max: 0) + (selection-firstShown min: 0).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">i≠0⇒ [para&larr;nil. firstShown &larr; firstShown + i. lastShown &larr; lastShown + i]]].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(frame &larr; window inset: 2) width &larr; 999.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para is: String⇒ ["</span><span style="font: italic 10pt serif">if para is a String, refresh from it directly</span><span style="font: 10pt serif">"]<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"otherwise compute para."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; [para≡nil⇒ [(String new: 200) asStream] para].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: firstShown to: lastShown do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[0&lt;i and⦂ i≤len⇒ [lines &larr; lines-1. (list◦i) printon: s]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">s append: self dummy].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">s cr].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: (lines+1 min: s limit - s position) do⦂ [s cr].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para &larr; s asArray]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">scrollBy⦂ expr copying: src into: dest showing: item in: frame direction: n<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| strm final stop pt delay chars locked t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[strm &larr; Stream new. chars &larr; 2*frame width/self lineheight. para &larr; String new: chars.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; dest origin. final &larr; [n&lt;0⇒ [0] list length+1].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">stop &larr; [locked&larr;self locked⇒ [0 max: (list length+1 min: (lastShown - firstShown * n sign + selection))] final].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ item≠stop do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[firstShown &larr; firstShown + n. lastShown &larr; lastShown + n. item &larr; item + n.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm of: para from: 1 to: chars.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[item≠final⇒ [(list◦item) printon: strm] self dummy copyto: strm].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm cr. src blt: pt mode: storing. self show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(t&larr; expr eval) abs ≤1⇒ [for⦂ delay to: chars/4 do⦂ [strm myend]. para &larr; nil. ⇑self]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">t*n&lt;0⇒[⇑self]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para &larr; nil. locked and: stop≠final⇒ [locked flash. ⇑false]]</span><span style="font: bold 10pt serif"><br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">scrollControl⦂ expr<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| dY onlyFirst butFirst onlyLast butLast x1 x2 y1 y2 y3 y4 k<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Selection is highlighted.  Unhighlight it.  Invalidate my saved para if I scroll.  Then reselect selection, or deselect if it is no longer displayed."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self compselection. dY &larr; self lineheight.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">x1 &larr; window origin x. x2 &larr; window corner x.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y1 &larr; window origin y+2. y4 &larr; window height-4 |dY + y1. y2&larr;y1+dY. y3&larr;y4-dY.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">onlyFirst &larr; x1+2⌾y1 rect: 2000⌾y2. butFirst &larr; x1⌾y2 rect: x2⌾y4.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">onlyLast &larr; x1+2⌾y3 rect: 2000⌾y4. butLast &larr; x1⌾y1 rect: x2⌾y3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ (k&larr;expr eval)≠0 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[k&gt;0⇒[UpCursor topage1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self scrollBy⦂ expr eval copying: butFirst into: butLast showing: lastShown<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">in: onlyLast direction: 1⇒[] ⇑self select: selection]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">DownCursor topage1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self scrollBy⦂ expr eval copying: butLast into: butFirst showing: firstShown<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">in: onlyFirst direction: ¬1⇒[] ⇑self select: selection].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self select: selection]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">scrollUp: n </span><span style="font: 10pt serif">| c<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[c &larr; window origin x-20.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self scrollControl⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user buttons=4⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user mp x &gt; c⇒[2] ¬2]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">0]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selectionRect </span><span style="font: 10pt serif">| h w<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"I have a selection.  Return its highlighting rectangle."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(w &larr; window inset: 2) height &larr; h &larr; self lineheight. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑w + (0⌾(selection-firstShown *h))]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪ListPane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"ClassPane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;ClassPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: ListPane<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;systemPane organizationPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;editmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a list pane that displays the names of all the classes of a category</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu &larr; Menu new string: &rsquo;filout<br>print<br>forget&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">from: systemPane to: organizationPane</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[systemPane &larr; nil. super close]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">If there is a selection, let the user choose a command from the menu.</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection=0⇒ [window flash]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">editmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ ["</span><span style="font: italic 10pt serif">filout</span><span style="font: 10pt serif">" (Smalltalk◦(list◦selection)) filout];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒ ["</span><span style="font: italic 10pt serif">print</span><span style="font: 10pt serif">" (Smalltalk◦(list◦selection)) printout];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒ ["</span><span style="font: italic 10pt serif">forget</span><span style="font: 10pt serif">" systemPane forget: list◦selection]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ListPane protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"I just lost my selection.  Tell organizationPane to display nothing."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">organizationPane class: nil.]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"My selection just changed.  Tell organizationPane to display the categories of my newly selected Class."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">organizationPane class: Smalltalk◦(list◦selection).]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Browser protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[systemPane compile: parag]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dirty<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑organizationPane dirty]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">noCode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection=0⇒ [⇑systemPane noCode] ⇑&rsquo;&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪ClassPane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">ClassPane classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"Menu"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Menu&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Object<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;str text thisline frame&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a list of text lines one of which can be selected with the pointing device</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rescan </span><span style="font: italic 10pt serif">" | each. Menu allInstances notNil transform⦂ each to⦂ each rescan."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self string: str]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"rescan (for new fonts, lineheight)"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">string: str </span><span style="font: 10pt serif">|  i pt tpara<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[[str last≠13⇒[str&larr;str+&rsquo;<br>&rsquo;]].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"make sure str ends with CR"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">text &larr; Textframe new para: (tpara &larr; str asParagraph)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame:  (Rectangle new origin: (pt &larr;  0 ⌾ 0)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">corner: 1000 ⌾ 1000).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; text maxx: str length+1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">text frame growto: pt + (4 ⌾ 0).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">tpara center.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame &larr; text frame inset: ¬2  ⌾ ¬2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline &larr; Rectangle new origin: text frame origin<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">corner: text frame corner x ⌾ text lineheight]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">stringFromVector: v </span><span style="font: 10pt serif">| s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["DW classInit"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; Stream default.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ v from: v do⦂ [s append: v; cr].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self string: s contents]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>User interactions</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bug </span><span style="font: 10pt serif">| index bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bits &larr; self movingsetup.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"set up and save background"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">index &larr; self bugit.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"get the index"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame bitsFromString: bits.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"restore background"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ index</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"return index"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">clear<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[frame clear]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fbug </span><span style="font: 10pt serif">| index<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"for fixed menus"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">index &larr; self bugit.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"get the index"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ index</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"return index"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">frame<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ frame]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">has: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ text frame has: pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">moveto: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self clear.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame moveto: pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">text frame moveto: pt+2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline moveto: pt+2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rebug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user waitbug. </span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"wait for button down again"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑</span><span style="font: italic 10pt serif">"bugcursor showwhile⦂"</span><span style="font: 10pt serif"> self bug]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">show<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[frame clear: black. text show.]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">wbug </span><span style="font: 10pt serif">| index bits [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"save background, display menu"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; self movingsetup.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"wait until a mouse button is down"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user anybug do⦂ [].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"get selection (possibly 0)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">index &larr; self bugit.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"restore background"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame bitsFromString: bits.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ index<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">zbug </span><span style="font: 10pt serif">| index bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bits &larr; self movingsetup.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ (index &larr; self bugit) = 0 do⦂ [].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame bitsFromString: bits.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ index<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Internal</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bugit </span><span style="font: 10pt serif">| pt bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user nobug ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑0]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"accidental bug returns 0"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline comp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ true do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[text frame has: (pt &larr; user mp) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user anybug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[thisline has: pt⇒[]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; text ptofpt: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline comp.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"selection follows mouse"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline moveto: text frame origin x  ⌾ pt y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline comp]<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑1+ (thisline origin y-text frame origin y<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">/ text lineheight)</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"return index"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline comp. </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"he left the menu"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ [text frame has: user mp] do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user nobug⇒[⇑0]] </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"return 0 for abort"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">thisline comp]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"he came back"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">movingsetup </span><span style="font: 10pt serif">| pt bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pt &larr; user mp - thisline center.</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"center prev item on mouse"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">text frame moveby: pt. thisline moveby: pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame moveby: pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; frame bitsIntoString.</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"save background"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame clear: black. text show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Menu under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"OrganizationPane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;OrganizationPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: ListPane<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;classPane selectorPane class&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;editmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a list pane that displays the selector categories of a class.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">class: class<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self of: (self listFor: class)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu &larr; Menu new string: &rsquo;filout<br>print&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">from: classPane to: selectorPane</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">listFor: class<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑[class≡nil⇒ [Vector new: 0]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">↪(ClassDefinition ClassOrganization) concat: class organization categories]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[classPane &larr; nil. super close]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["If there is a selection, let the user choose a command from the menu."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection≤1⇒ [window flash]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"Can&rsquo;t filout or print definition by itself"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">editmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ ["filout the selected category"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection=2⇒ [class filoutOrganization]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">class filoutCategory: list◦selection];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒ ["print the selected category"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection=2⇒ [window flash]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"Can&rsquo;t print organization"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">class printoutCategory: list◦selection]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ListPane protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"I just lost my selection.  Tell selectorPane to display nothing."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selectorPane of: (Vector new: 0)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selectorPane of: [selection≤2⇒ [Vector new: 0] class organization category: list◦selection]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Browser protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">code: selector<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑class code: selector]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| sel cat<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[class≡nil or⦂ selection=1⇒ [classPane compile: parag] </span><span style="font: italic 10pt serif">"new definition"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection=2⇒ [class organization fromParagraph: parag. self class: class] </span><span style="font: italic 10pt serif">"new organization"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">cat &larr; [selection=0⇒ [&rsquo;As yet unclassified&rsquo;] list◦selection].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">sel &larr; selectorPane compile: parag in: class under: cat⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self revise: (self listFor: class) with: cat.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection≠0⇒ [selectorPane revise: (class organization category: cat) with: sel]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dirty<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑selectorPane dirty]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">execute: parag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑classⓢ parag]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">forget: selector </span><span style="font: 10pt serif">| cat<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[class derstands: selector.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">cat &larr; list◦selection.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self revise: (self listFor: class) with: cat.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection&gt;0⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selectorPane revise: (class organization category: cat) with: selector]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">noCode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[class≡nil⇒ [⇑classPane noCode]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection=0⇒ [⇑&rsquo;&rsquo;]; =1⇒ [⇑class definition]; =2⇒ [⇑class organization]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑&rsquo;Message name and Arguments | Temporary variables "short comment"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["long comment if necessary"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Smalltalk<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Statements]&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">spawn: selector with: parag formerly: oldparag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selectorPane compselection; select: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">class edit: selector para: parag formerly: oldparag]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪OrganizationPane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">OrganizationPane classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"ScrollBar"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;ScrollBar&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Object<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;rect bitstr owner position&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;DownCursor UpCursor JumpCursor &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a bar to the left of an awake window.  With the cursor in me I can make that window scroll.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[UpCursor &larr; Cursor new fromtext: &rsquo;<br>1000000000000000<br>1100000000000000<br>1110000000000000<br>1111000000000000<br>1111100000000000<br>1111110000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DownCursor &larr; Cursor new fromtext: &rsquo;<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1100000000000000<br>1111110000000000<br>1111100000000000<br>1111000000000000<br>1110000000000000<br>1100000000000000<br>1000000000000000&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">JumpCursor &larr; Cursor new fromtext: &rsquo;<br>0111000000000000<br>1111100000000000<br>1111100000000000<br>0111000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000&rsquo; offset: 2⌾1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">on: f from: o<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self on: f from: o at: o scrollPos]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">on: frame from: owner at: f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rect &larr; Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin: frame origin-(32⌾2)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: 32⌾(frame height+4).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">position &larr; Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin: rect origin+(9⌾4)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: 16⌾8.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxPosition&larr; f]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Scheduling</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[owner&larr;nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">eachtime </span><span style="font: 10pt serif">| p cx r</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">This needs to be restructured</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rect has: (p&larr; user mp)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[cx &larr; rect center x - 2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">p x &lt; cx⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[r &larr; Rectangle new origin: rect origin corner: cx⌾rect maxY.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">DownCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[while⦂ (r has: (p&larr;user mp)) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self slide: p⇒[owner scrollTo: (position minY-rect minY-4) asFloat/(rect height-12)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug⇒[self reposition⦂[owner scrollUp: rect origin y - p y]]]]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new origin: cx⌾rect minY corner: rect corner.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">UpCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[while⦂ (r has: (p&larr;user mp)) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self slide: p⇒[owner scrollTo: (position minY-rect minY-4) asFloat/(rect height-12)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug⇒[self reposition⦂[owner scrollUp: p y - rect origin y]]]]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">firsttime</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑rect has: user mp]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">lasttime</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">slide: p </span><span style="font: 10pt serif">| bug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[position has: p⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[JumpCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bug &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ ((position has: user mp) and⦂ bug≡false) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user redbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bug &larr; true.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user redbug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self reshow⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[position moveto: position origin x⌾<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((user mp y max: rect origin y+4) min: rect corner y-12)]]]]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑bug]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Image</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">boxPosition&larr; f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[position moveto: rect origin+<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(9⌾(4+(([f&lt;0.0⇒[0.0]; &gt;1.0⇒[1.0] f])*(rect height-16))))]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hide </span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">restore background</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bitstr≡nil⇒ [user notify: &rsquo;Attempt to hide unshown scrollbar&rsquo;]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect bitsFromString: bitstr.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitstr &larr; nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hidewhile⦂ expr  </span><span style="font: 10pt serif">| v<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self hide. v &larr; expr eval. self show. ⇑v]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">reposition⦂ expr<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self reshow⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[expr eval.  self boxPosition&larr; owner scrollPos]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">reshow⦂ expr </span><span style="font: 10pt serif">| r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[r &larr; position inset: ¬2.  expr eval.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r clear: white.  position outline]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">show</span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">Save background and turn gray</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bitstr &larr; rect bitsIntoString.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect clear: black.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(rect inset: 2⌾2 and: 1⌾2) clear: white.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">position outline]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪ScrollBar under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">ScrollBar classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"SelectorPane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;SelectorPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: ListPane<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;organizationPane codePane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;editmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a ListPane whose entries are the message selectors of a category within a class.  Only organizationPane knows what the class and category are.  I make codePane display the code of my selected selector, if any.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu &larr; Menu new string:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">&rsquo;spawn<br>forget&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">from: organizationPane to: codePane</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[organizationPane &larr; nil. super close]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection=0⇒ [window flash]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar hidewhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[editmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ [organizationPane spawn: list◦selection with: codePane contents<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">formerly: codePane oldContents];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒ [organizationPane forget: list◦selection]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ListPane protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[codePane showing: organizationPane noCode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[codePane showing: (organizationPane code: list◦selection)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Browser protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑organizationPane compile: parag]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag in: class under: heading<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑codePane compile: parag in: class under: heading]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dirty<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑codePane dirty]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">execute: parseStream for: codePane<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑codePane execute: parseStream in: false to: nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪SelectorPane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SelectorPane classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"StackPane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;StackPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: ListPane<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;contextVarPane instanceVarPane codePane variables proceed&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;stackmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a list pane that displays one or all of the stack below a context in a notify window.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[stackmenu &larr; Menu new string:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">&rsquo;stack<br>spawn<br>proceed<br>restart&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">context: contextVarPane at: level instance: instanceVarPane code: codePane<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[variables &larr; (Vector new: 16) asStream.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> proceed≡nil⇒[proceed &larr; (false, nil, level)]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">context: contextVarPane instance: instanceVarPane code: codePane<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[variables &larr; (Vector new: 16) asStream.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> proceed≡nil⇒[proceed &larr; (false, nil, Top currentPriority)]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">interrupt: flag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[proceed◦1 &larr; flag]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[Top enable: proceed◦3. super close. list⇒ [(list◦1) releaseFully]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[scrollBar hidewhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[stackmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ [</span><span style="font: italic 10pt serif">"show a full backtrace"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> self revise: (list◦1) stack with: [selection=0⇒ [nil] list◦selection]];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒ [</span><span style="font: italic 10pt serif">"spawn a code editor"</span><span style="font: 10pt serif"> self spawn];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒ [</span><span style="font: italic 10pt serif">"return to selected context"</span><span style="font: 10pt serif"> self continue: false];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒ [</span><span style="font: italic 10pt serif">"restart selected context"</span><span style="font: 10pt serif"> self continue: true]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ListPane protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[contextVarPane ≡ false⇒ []<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">codePane showing: &rsquo;&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">contextVarPane names: (Vector new: 0) values: ↪(nil) wrt: false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">instanceVarPane names: (Vector new: 0) values: ↪(nil) wrt: false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">locked<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑contextVarPane and⦂ (selection&gt;0 and⦂ self dirty)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selected </span><span style="font: 10pt serif">| context instance code safeVec<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[contextVarPane ≡ false⇒ []<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">context &larr; list◦selection. instance &larr; context receiver.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Decompiler new findPC: context pc.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">code &larr; self code.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">codePane showing: [code⇒ [code] &rsquo;&rsquo;].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">codePane selectRange: Decompiler new highlight.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">variables reset. context variableNamesInto: self with: nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[code⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[contextVarPane names: (↪(thisContext) concat: variables contents)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">values: (context, context tempframe) wrt: context.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> context tempframe≡nil⇒ [user notify: &rsquo;NIL TEMPFRAME&rsquo;]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> contextVarPane names: ↪(thisContext) values: context inVector wrt: context].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">variables reset. instance class fieldNamesInto: self.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">safeVec &larr; Vector new: 2. safeVec all &larr; instance.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">instanceVarPane names: (↪(self) concat: variables contents) values: safeVec wrt: context.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">contextVarPane select: 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>NotifyWindow protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parseStream </span><span style="font: 10pt serif">| ctxt selector method mcl<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ctxt &larr; list◦(selection max: 1). mcl &larr; ctxt mclass.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> proceed◦2 &larr; selector &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">codePane compile: parseStream in: mcl under: &rsquo;As yet unclassified&rsquo;⇒<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> </span><span class="tab" val="79"></span><span style="font: 10pt serif">[codePane reflects: selection⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[method &larr; mcl md methodorfalse: selector⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self releaseAboveSelection.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> </span><span class="tab" val="79"></span><span style="font: 10pt serif">ctxt restartWith: method. proceed◦1 &larr; true.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> </span><span class="tab" val="79"></span><span style="font: 10pt serif">self of: list◦(selection to: list length) copy; select: 1]]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dirty<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑codePane and⦂ codePane dirty]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">execute: parseStream for: codePane<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑proceed◦2 &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">codePane execute: parseStream in: [selection=0⇒ [false] list◦selection] to: nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Private</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">code </span><span style="font: 10pt serif">| mclass selector </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"code of my selected context"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[mclass &larr; (list ◦ selection) mclass.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selector &larr; self selector.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(mclass canunderstand: selector) and⦂ (mclass code: selector)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">comment: s</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"called by selected via Class fieldNamesInto"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">contents</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"called by selected via Class fieldNamesInto"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">continue: restarting </span><span style="font: 10pt serif">| ctxt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Close my window and resume my selected context, if any, else my first context.  If interrupted (proceed◦1) or restarting or a recompiled method, don&rsquo;t return a value; otherwise, return proceed◦2."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user leftShiftKey ⇒[mem◦067 &larr; 58 "turn display off"]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection=0⇒ [selection&larr;1]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ctxt &larr; list◦selection.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self releaseAboveSelection.</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"release abandoned contexts"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[restarting⇒ [ctxt restart]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> proceed◦1 and: selection=1⇒ [</span><span style="font: italic 10pt serif">"resume after interrupt"</span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> ctxt push: proceed◦2].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">list &larr; false. </span><span style="font: italic 10pt serif">"Inhibit me closing."</span><span style="font: 10pt serif"> user topWindow vanish.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">list &larr; nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[proceed◦3=1⇒[thisContext sender release]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Top run: ctxt at: proceed◦3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Top enable: proceed◦3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Top wakeup: proceed◦3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Top resetCurrent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">declaration: dummy1 name: string asArg: dummy2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[variables next &larr; string]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">identifier: s</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"called by selected via Class fieldNamesInto"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[variables next &larr; s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">notify: msg </span><span style="font: italic 10pt serif">"selected context doesnt know its variables"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">releaseAboveSelection<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[[selection&gt;1⇒ [(list◦(selection-1)) sender &larr; nil. (list◦1) release</span><span style="font: italic 10pt serif">"Fully"</span><span style="font: 10pt serif">]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(list◦(selection max: 1)) verifyFrames]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selector </span><span style="font: 10pt serif">| context<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[context &larr; list◦(selection max: 1).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑[context sender≡nil⇒ [false] context selector]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">separator: c</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"called by selected via Class fieldNamesInto"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">spawn </span><span style="font: 10pt serif">| mclass selector parag oldparag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[mclass &larr; (list◦(selection max: 1)) mclass.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selector &larr; self selector.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">parag &larr; [codePane⇒ [codePane contents] mclass canunderstand: selector⇒ [mclass code: selector] &rsquo;&rsquo;].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">oldparag &larr; [codePane⇒ [codePane oldContents] false].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self compselection; select: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">mclass edit: selector para: parag formerly: oldparag]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">terminate </span><span style="font: italic 10pt serif">"called by parser close during initialization"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">trailer: s</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"called by selected via Class fieldNamesInto"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪StackPane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">StackPane classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"SystemPane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;SystemPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: ListPane<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;mySysOrgVersion classPane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;sysmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a list pane in which all the system categories are displayed.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[sysmenu &larr; Menu new string: &rsquo;filout<br>print&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">to: classPane</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">update<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self of: (↪(AllClasses SystemOrganization) concat: SystemOrganization categories). mySysOrgVersion&larr;user classNames]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">enter</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"> </span><span style="font: italic 10pt serif">"be sure I am up to date"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[mySysOrgVersion≡user classNames⇒ [super enter]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">window outline. self update. super enter]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">leave</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"> </span><span style="font: italic 10pt serif">"I am up to date"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[mySysOrgVersion &larr; user classNames. super leave]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection&lt;3⇒[window flash]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar hidewhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[sysmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[SystemOrganization filoutCategory: list◦selection];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[SystemOrganization printCategory: list◦selection]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ListPane protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[classPane of: (Vector new: 0)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[classPane of: self classes]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Browser protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classes </span><span style="font: italic 10pt serif">"return a Vector of the classes in my selected category"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection</span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ [⇑user classNames];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">≤2⇒ [⇑Vector new: 0]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑SystemOrganization category: list◦selection]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| class cat className<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection=2⇒ [SystemOrganization fromParagraph: parag. self update] </span><span style="font: italic 10pt serif">"new organization"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">cat &larr; [selection≤1⇒ [false] list◦selection].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">class &larr; nilⓢparag.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">class Is: Class⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[className &larr; class title unique.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[cat⇒ [SystemOrganization classify: className under: cat]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">mySysOrgVersion≡user classNames⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection&gt;0⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[classPane of: [cat⇒ [SystemOrganization category: cat] user classNames]]]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dirty<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑classPane dirty]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">forget: className<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user notify: &rsquo;Class &rsquo;+className+&rsquo; will disappear if you proceed...&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(Smalltalk◦className) noChanges; obsolete. Smalltalk delete: className.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">SystemOrganization delete: className.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">AllClassNames &larr; AllClassNames delete: className.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">classPane revise: self classes with: className]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">noCode<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection=0⇒ [⇑&rsquo;&rsquo;]; =2⇒ [⇑SystemOrganization]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑&rsquo;Class new title: &rsquo;&rsquo;NameOfClass&rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">subclassof: Object<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">fields: &rsquo;&rsquo;names of fields&rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">declare: &rsquo;&rsquo;names of class variables&rsquo;&rsquo;&rsquo; copy]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪SystemPane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemPane classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"VariablePane"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;VariablePane&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: ListPane<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;valuePane values context&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;varmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a list pane that displays the names of variables in a context or instance.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[varmenu &larr; Menu new string: &rsquo;inspect&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">names: vars values: values wrt: context<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self of: vars]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">to: valuePane<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Window protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection=0⇒ [window flash]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrollBar hidewhile⦂ [varmenu bug =1⇒ [self value inspect]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ListPane protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[valuePane showing: &rsquo;&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">selected<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[valuePane showing: self value asString]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Notify/Inspect protocol</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">compile: parag<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[window flash. ⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">execute: parseStream for: valuePane<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑valuePane execute: parseStream in: context to: values◦1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Private</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">value<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection=1⇒ [⇑values◦1] ⇑(values◦2) inspectfield: selection-1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪VariablePane under: &rsquo;Panes and Menus&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">VariablePane classInit</span></div>
<script>function do_tabs() { // unit = px
  var tabs = document.getElementsByClassName("tab");
  for (var i = 0; i < tabs.length; ++i) {
    var span = tabs[i];
    var val = span.getAttribute("val");
    if (val == null) console.log("Couldn't get val");
    var rect = span.getBoundingClientRect();
    var tabstop;
    if (val > 0) tabstop = Math.ceil(rect.left / val) * val;
    else tabstop = -val;
    console.log("do_tabs", val, tabstop)
    if (tabstop > 0) {
      var width = tabstop - rect.left;
      span.style.display = "inline-block";
      span.style.width = width + "px";
    }
  }
}
do_tabs();
</script>
  </body>
</html>
