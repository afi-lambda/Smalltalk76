<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>Smalltalk76/FPI-Packages.st</title>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">&rsquo;From Smalltalk 5.5k XM November 24 on 22 November 1980 at 2:57:08 am.&rsquo;<br></span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">"BitImage"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;BitImage&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Image<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;strips nstrips&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;brush aurora stripheightSPARE stripheight black white bitimagemenu erase SPARE color formmenu under reverse blankcursor over dotsetter &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class is a virtual bit map represented as a smalltalk String</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets up colors and effects for BITBLT."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">black &larr; 0-1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">white &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">over &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">under &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">reverse &larr; 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">erase &larr; 3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush &larr; Form new extent: 5⌾5. brush black.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">color &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">stripheight &larr; 20.<br>bitimagemenu &larr; Menu new string:<br>&rsquo;size<br>figure<br>ground<br>newform<br>pasteform<br>arc<br>areafill<br>shade<br>vertical<br>horizontal<br>rotate<br>&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurora &larr; "Aurora new" nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromImage: image <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["creates a virtual bit map with width = (image width) and height = (image height) with the bits in image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fromrectangle: image rectangle.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromrectangle: rect </span><span style="font: 10pt serif">| </span><span style="font: bold 10pt serif">r i leftover image yposition<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["creates a virtual bit map with width = (r width) , height = (r height)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> and the bits in rect. The Image is  made up of forms that are stripheight high."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super origin: rect origin extent: rect extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">nstrips &larr; (rect height + (stripheight -1))/stripheight.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">yposition &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">leftover &larr; rect height \ stripheight.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ (leftover = 0) ⇒ [leftover &larr; stripheight]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new origin: rect origin extent: (rect width)⌾stripheight.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: nstrips do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ i = nstrips ⇒ [ r extent &larr; ((rect width)⌾leftover)]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">image &larr; Image new origin: (0⌾0) extent: rect extent.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">image form: (Form new fromrectangle: r) ; path: (0⌾yposition).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addimage: image.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">yposition &larr; yposition + stripheight.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r translate: (0⌾stripheight).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="tab" val="79"></span><span style="font: bold 10pt serif">fromuser  | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["create a new Form whose rectangle is specified by the user. "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fromrectangle: r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromuserevenword  | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["create a new BitImage whose rectangle is specified by the user,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">truncated to nearest multiple of 16 (for Spruce printing). "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuserevenword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fromrectangle: r.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>PATTERN ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">erase </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets all bits in the BitImage to white ( to zeros)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: nstrips do⦂ [ (strips◦i) white]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">nstrips<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ nstrips <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">nstrips: nstrips <br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">saveScreenBits<br></span><span style="font: 10pt serif">[<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">strips <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the set of Forms making up this BitImage)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ strips<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">strips: strips <br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>MODULE ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">comment <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["see class Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">frame </span><span style="font: 10pt serif">[ ⇑ rectangle]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">moveto: pt  <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self translateto: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>FILING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">read: filename </span><span style="font: 10pt serif">| file subimage strip yposition i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Reads the Image in the format nstrips , Form(1) , Form(2) , Form(3) . . .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">Form(nstips). Where each Form is saved as width,height then bits.  "<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self origin: 0⌾0 extent: 1⌾1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">yposition &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">file&larr; (dp0 oldFile: filename) readonly.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nstrips &larr; file nextword.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: nstrips do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">strip &larr; Form new fromInstance: file.  <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addform: strip andpath: (0⌾yposition).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">yposition&larr; yposition+ strip height.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">file close.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">write: filename </span><span style="font: 10pt serif">| file subimage<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Saves the Form in the format nstrips , Form(1) , Form(2) , Form(3) . . .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">Form(nstips). Where each Form is saved as width,height then bits.  "<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">file &larr; (dp0 file: filename).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">file nextword&larr; nstrips.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ subimage from: self do⦂ [ file append: (subimage form) asInstance. ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">file close.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">displayat:  path effect: effect clippedBy: cliprect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super displayat: path effect: effect clippedBy: cliprect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">show<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super displayat: (0⌾0) effect: 0 clippedBy: user screenrect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy </span><span style="font: 10pt serif">| t i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return a copy of myself"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; BitImage new origin: (origin copy) extent: (self extent) copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂ [ t add: (self◦i) copy].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑3]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">printon: strm </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm append: &rsquo;a Bitmage: &rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">title <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ &rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>EDITING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">arc </span><span style="font: 10pt serif">| pt1 pt2 pt3 p pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["arc tool for forms."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user clear; print: &rsquo;Redbug 3 points&rsquo;; cr; print: &rsquo;Paints using current brush.&rsquo; .<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitnobug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt1 &larr; self blinkbrush].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitnobug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt2 &larr; self blinkbrush].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitnobug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt3 &larr; self blinkbrush].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt3 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p &larr; Path new init.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p addarcfrom: pt1 via: pt2 to: pt3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ pt from: p do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blinkbrush </span><span style="font: 10pt serif">| pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["to show current position of brush in the BitImage."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; self mp + rectangle origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">edit: superimage | bits <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["uses the BitRect toolbox editor"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter &larr; BitRectEditor new picture: self.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter firsttime.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ true do⦂ "forever"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(dotsetter lostMouse and: (user anybug)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter outside⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter lasttime.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; self fromrectangle: rectangle.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ bits<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter eachtime<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">grayEdit </span><span style="font: 10pt serif">| a b c i d p r v bits "edit up a gray pattern and return it"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["first a rectangle for it.  Then redbug is black, yellow is white,<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">blue terminates"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuser. bits&larr;0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">a &larr; r extent. a&larr; (a x max:  a y) | 4. a &larr; a⌾a.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">b &larr; r origin. r extent&larr; a; color: white mode: storing; moveby: 0⌾(0-a y).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c &larr; a/4.  d &larr; b rect: b+c.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user bluebug do⦂ [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug ⇒[p &larr; user mp -b /c.  i &larr; p y *4 +p x +1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">i&lt;1 or⦂ i&gt;16 ⇒[r flash]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">d moveto: b+(c*p); color: black mode: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; bits lor: (1 lshift: 16-i).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r color: bits mode: storing. user waitnobug]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user yellowbug ⇒[p &larr; user mp -b /c.  i &larr; p y *4 +p x +1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">i&lt;1 or⦂ i&gt;16 ⇒[r flash]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">d moveto: b+(c*p); color: white mode: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; (¬1 lxor:(1 lshift: 16-i)) land: bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r color: bits mode: storing. user waitnobug]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">] ⇑bits]<br>"aa grayEdit base8 ."</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">horizontalsymmetry </span><span style="font: 10pt serif">| r f i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["horizontal symmetry tool"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user clear; show: &rsquo;Define rectangle. Reflection will be around lower edge&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: ( r height) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f &larr; Form new fromrectangle: (Rectangle new origin: ((r origin x)⌾((r bottom)-i)) extent: ((r width)⌾1)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f displayat: (r origin x)⌾((r bottom) +i) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">line </span><span style="font: 10pt serif">| pt1 pt2 p pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["line tool for forms."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt1 &larr; self blinkbrush].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt2 &larr; self blinkbrush].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p &larr; Path new init.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p addlinefrom: pt1 to: pt2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ pt from: p do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">newbrush </span><span style="font: 10pt serif">|  pt rect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OriginCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; ( self mp)+ rectangle origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect &larr; pt rect: pt.</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rect reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">( self mp)+ rectangle origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect corner &larr; (rect origin) max: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">brush &larr; Form new fromrectangle: rect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pastebrush </span><span style="font: 10pt serif">| pt1 <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["one-copy tool for forms."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitnobug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OriginCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user redbug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt1 &larr; self blinkbrush].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt1 effect: (dotsetter tool mode) clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">resize: superimage </span><span style="font: 10pt serif">|  pt f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dotsetter leave.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">( pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(superimage  mp)+<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> superimage rectangle origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self corner&larr; pt max: ((self origin) + (16⌾16)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">self fromrectangle: rectangle.<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">self white ; display.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self edit: superimage<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rotate </span><span style="font: 10pt serif">| r f i j<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["90 degree rotation tool"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: ( r width) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ j to: ( r height) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f &larr; Form new fromrectangle: (Rectangle new origin: (((r origin x)+i)⌾(r top+j)) extent: (1⌾1)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f displayat: (((r corner x)+j))⌾((r top)+i) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">setfigure </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"for now just increment the figure color by 1 \ 12"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure &larr; (figure +1 ) \ 12.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: self do⦂ [ (t form) figure: figure].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self display<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">setground </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"for now just increment the ground color by 1 \ 12"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ground &larr; (ground +1 ) \ 12.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: self do⦂ [ (t form) ground: ground].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self display<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">verticalsymmetry </span><span style="font: 10pt serif">| r f i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["vertical symmetry tool"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user clear; show: &rsquo;Define rectangle. Reflection will be around right-hand edge&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: ( r width) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f &larr; Form new fromrectangle: (Rectangle new origin: (((r origin x)+(r width)-i)⌾(r top)) extent: (1⌾(r height))).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f displayat: ((r corner x) + i)⌾(r top) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug </span><span style="font: 10pt serif">| <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitimagemenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self resize: superimage<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]; "change size"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self setfigure];</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self setground];</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self newbrush];</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=5⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self pastebrush];</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=6⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self arc ];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=7⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[Rectangle new fromuser fillin: ((dotsetter tool) tone)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">mode: ((dotsetter tool) mode) ];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=8⇒  [(dotsetter tool) shade];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=9⇒  [self verticalsymmetry];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=10⇒  [self horizontalsymmetry];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=11⇒  [self rotate]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪BitImage under: &rsquo;FPI Packages&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">BitImage classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"BorderedText"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;BorderedText&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: TextImage<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">displayat: pt effect: effect clippedBy: cliprect | origin corner<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["display text and border around it "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super displayat: pt effect: effect clippedBy: cliprect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; frame origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">corner &larr; frame corner.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin: origin-(1⌾1) corner: (corner x+1)⌾origin y)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">color: ¬1 mode: effect;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">moveto: (origin x-1)⌾corner y; color: ¬1 mode: effect;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; corner x⌾(origin y-1); color: ¬1 mode: effect;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">moveto: origin-(1⌾1); color: ¬1 mode: effect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr;  BorderedText new paragraph: para copy frame: (frame copy) style: style copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t c1&larr; c1 ; c2&larr; c2 ; begintypein &larr; begintypein.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑6]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">presson: press in: r | scale<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scale &larr; press scale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press setp: (r origin x- scale)⌾(r corner y-(3*scale)) ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">showrectwidth: (scale*(2+self width)) height: scale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press setp: (r origin x- scale)⌾(r corner y-((self height+5)*scale)) ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">showrectwidth: (scale*(2+self width)) height: scale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press setp: (r origin x- scale)⌾(r corner y-(scale*(self height+4))) ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">showrectwidth: scale height: (scale*(self height+2)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press setp: (r origin x+(scale*(self width)))⌾(r corner y-(scale*(self height+4))) ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">showrectwidth: scale height: (scale*(self height+2)).<br><br>⇑ para presson: press in: r.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪BorderedText under: &rsquo;FPI Packages&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"Document"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Document&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Image<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;displayorder style&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;leading micasperinch &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>basic document class</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>EDITING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bubbledelete: image </span><span style="font: 10pt serif">| delta i k<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["delete image from the document  and subtracting images extent y from all subimages below it."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; self find: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deleteI: i .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; image extent y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ k from: i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self◦k) translate: (0⌾(0-delta))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bubbleinsert: image </span><span style="font: 10pt serif">| delta i k<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["insert image into the document keeping the document y-sorted and adding images extent y to all subimages below it."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; self findindex: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self insertI: i value: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; image extent y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ k from: i+1 to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self◦k) translate: (0⌾delta)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">delete: image </span><span style="font: 10pt serif">|  i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["delete image from the document and leave its space. "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; self find: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i⇒ [ self deleteI: i.]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">edit <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Documents are edited with a DocumentEditor"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">DocumentEditor new init: self.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">findindex: image </span><span style="font: 10pt serif">| y guess top bottom<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["binary search on the origins of the rectangles surrounding my subimages<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">returns the index of the subimage just below image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">position = 0 ⇒ [ ⇑ 1]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">top &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bottom &larr; position.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y&larr; image rectangle origin y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y ≤ ((self◦1) rectangle origin y) ⇒ [ ⇑ 1].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y ≥ ((self◦position) rectangle origin y) ⇒ [ ⇑ position+1]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">guess &larr; position/2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂  bottom = (top+1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[((self◦guess) rectangle origin y) ≥ y ⇒ [ bottom &larr; guess ] top &larr; guess].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">guess &larr; (bottom + top) /2<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ bottom<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">insert: image </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["insert image into the document keeping the document y-sorted."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; self findindex: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self insertI: i value: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">resize </span><span style="font: 10pt serif">| delta t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["make sure the document does not have subimages that have negative y values and resize the document"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[position ≥ 1 ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(delta &larr; (self◦1) top) ≤ 0 ⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: self do⦂ [ t translate: (0⌾(0-delta)) ] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super resize<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">micasperinch &larr; 2540.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">name<br>[ ⇑  displayorder </span><span style="font: 10pt serif">"returns the name of the document ( displayorder is currently used for name... note that name is a string."<br></span><span style="font: bold 10pt serif"> ] <br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">name: displayorder <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets the name of the document ( displayorder is currently used for name... note that name is a string."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy </span><span style="font: 10pt serif">| im i<br>[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">im &larr; Document new origin: origin copy rectangle: rectangle copy path: path copy form: form copy figure: figure copy ground: ground copy xgrid: xgrid copy  ygrid: ygrid copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[im add: (self◦i) copy].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">im name: (self name) copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ im<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromPress: displayorder </span><span style="font: 10pt serif">| press s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">retrieves an instance of class Document from a press file</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user displayoffwhile⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self default.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> press &larr; (dp0 pressfile: </span><span style="font: bold 10pt serif">displayorder</span><span style="font: 10pt serif">). press open.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; (press nextControl) asStream.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s next = self pressCode ⇒ [self fromPress: press value: s]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;error in pressfile&rsquo;.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromPress: press value:  s </span><span style="font: 10pt serif">| numberofsubimages t t1 i code <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["builds an instance of class Document from a press file"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">numberofsubimages&larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t1 &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr; t rect: t1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">xgrid &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ygrid &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">displayorder&larr; s nextString.</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: numberofsubimages do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s &larr; (press nextControl) asStream.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">code &larr; s next. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; [code = 1⇒ [Image new]; = 2⇒ [Heading new];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">= 3⇒ [BitImage new] false].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">t and⦂ code = t pressCode⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addimage: (t fromPress: press value: s)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;illegal code or code mismatch&rsquo;]</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hardcopy </span><span style="font: 10pt serif">|</span><span class="tab" val="79"></span><span style="font: 10pt serif">p i press bottoms rect pressscale pageheight pagewidth  lastrect </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">currentrect oldytop oldybottom <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">oldytop &larr; 11*micasperinch.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pageheight &larr; 11*micasperinch.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pagewidth&larr; 8*micasperinch.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user displayoffwhile⦂ <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press &larr; dp0 pressfile: (displayorder + &rsquo;.doc&rsquo;).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pressscale &larr; press scale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self hidePress: press complete: ¬1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p &larr; PressPrinter init.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p press: press;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame &larr;  ("in micas"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((1*micasperinch)⌾(1*micasperinch)) rect:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((pagewidth-micasperinch)⌾(pageheight-micasperinch))).<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">lastrect &larr; ((self◦1) rectangle)*pressscale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect &larr; ((lastrect leftside)⌾(1*micasperinch))<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect: ((lastrect rightside) ⌾(pageheight - (lastrect top))).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">oldybottom &larr; p print: self◦1 in: rect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: (2 to: self length) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[oldybottom &gt; oldytop⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">["page break" oldytop &larr; pageheight-micasperinch.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">currentrect&larr; ((self◦i) rectangle) * pressscale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(currentrect top &gt; lastrect bottom)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[oldytop &larr; oldybottom+(lastrect bottom-currentrect top)"no overlap"]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">oldytop &larr; (oldytop+(lastrect top-currentrect top))"overlap"].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect &larr; ((currentrect leftside)⌾(1*micasperinch))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect: ((currentrect rightside) ⌾(oldytop)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">oldybottom &larr; p print: (self◦i) in: rect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">lastrect &larr; ((self◦i) rectangle)*pressscale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press close; toPrinter "send over ethernet to printer"]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hideData: complete </span><span style="font: 10pt serif">| s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["stores an instance of class Document from a press file"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; Stream new of: (String new: 100).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s nextword&larr; self length; "number of subimages"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; rectangle origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; rectangle corner;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword&larr; xgrid;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword&larr; ygrid;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextString&larr; displayorder.</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ s contents]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑0]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">printon: strm </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm append: &rsquo;a Document &rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Document under: &rsquo;FPI Packages&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">Document classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"DocumentEditor"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;DocumentEditor&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Window<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;document documentwindow screenimage firstindex lastindex<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">indexofselection selection &rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;jumpcursor documentmenu scrap blankcursor &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">buildscreenimage |</span><span style="font: 10pt serif"> i r delta  <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["This function copies the subimages intersecting the document window<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">into the screen image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage &larr; Image new origin: self frame origin extent: self frame extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage  xgrid: (document xgrid) ; ygrid: (document ygrid).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; documentwindow origin y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">firstindex &larr; 1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">" find the index of the first subimage that intersects the document window."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ ((firstindex≥(document length)) or⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((((document◦firstindex) rectangle) bottom) &gt; (documentwindow top))) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[firstindex &larr; firstindex+1].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">lastindex &larr; firstindex.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: (firstindex to: document length) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((((document◦i) rectangle) top) &lt; (documentwindow bottom))⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[lastindex &larr; i. screenimage add: (((document◦i) "copy")<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">translate: 0⌾0 - (0⌾delta))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] ⇑ lastindex<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit <br></span><span style="font: italic 10pt serif">"  DocumentEditor classInit.    "<br></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: 10pt serif">documentmenu &larr; Menu new string:<br>&rsquo;move<br>erase<br>place<br>cut<br>paste<br>copy<br>top<br>bottom<br>jump<br>addspace<br>deletespace<br>show<br>&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">jumpcursor &larr; Cursor new fromtext: &rsquo;<br>1111111111111111<br>1111111111111111<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000001110000000<br>0000011111000000<br>0000011111000000<br>0000001110000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>0000000000000000<br>1111111111111111<br>1111111111111111&rsquo; offset: 2⌾1.<br>]<br><br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">defaultdocument <br></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self defaultdocument: &rsquo;document&rsquo;<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">defaultdocument: name </span><span style="font: 10pt serif">| defaultdocument run r textimage f im dot heading head text char b image row<br>[" name is a string"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument &larr; Document new origin: 0⌾0<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: (user screenrect) extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument name: name.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument xgrid: DefaultTextStyle tab.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument ygrid: DefaultTextStyle lineheight.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">textimage &larr; BorderedText new.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">textimage text: &rsquo;Text that is bordered&rsquo; width: 200.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument addform: textimage andpath: 0⌾0.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">textimage &larr; TextImage new.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">textimage text: &rsquo;This is a paragraph&rsquo; width: 600.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument addform: textimage andpath: 0⌾0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">b &larr; BitImage new fromrectangle:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(Rectangle new origin: 0⌾200 extent: 100⌾100).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument insert: b.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">head &larr; Set new default.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">text &larr; &rsquo;HEADING&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ char from: text do⦂ [ head add: char ].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">heading &larr; Heading new origin: 0⌾400 index: 9 charactercodes: head<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">currentcharacter: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">defaultdocument insert: heading.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"defaultdocument insert: CurveIdiom new init."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self init: defaultdocument.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">init: document </span><span style="font: 10pt serif">| i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["This is the paragraph (subimage) level document editor."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fixedwidthfromuser: document width.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">documentwindow &larr; Rectangle new origin: document rectangle origin<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: (document width) ⌾ (self frame height).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user topWindow leave.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self takeCursor; enter.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user restartup: self<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>DEFAULT EVENT RESPONSES</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document close.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document &larr; nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage &larr; Vector new: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">enter </span><span style="font: 10pt serif">[selection &larr; false. self show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hardcopy<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["write a press file and hardcopy this document"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self leave.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self top.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document hardcopy<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">kbd | c x y<br>[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">   c &larr; user kbd. <br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">c = 120⇒<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ user clearshow: &rsquo;x gridding is &rsquo;. document xgrid print.<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user cr.<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">document xgrid: (x&larr;<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(user request: &rsquo;x gridding . . . &rsquo;) asInteger).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage xgrid: x. <br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] <br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">c = 121⇒<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ user clearshow: &rsquo;y gridding is &rsquo;. document ygrid print.<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user cr.<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">document ygrid: (y&larr;<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(user request: &rsquo;y gridding . . . &rsquo;) asInteger).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage ygrid: y.<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] <br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">leave<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document ≡ nil ⇒ []<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection⇒ [ selection highlite]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update ; buildscreenimage.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">print <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["write a press file and hardcopy this document"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document hardcopy<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">redbug | pt rect newrect start t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pt &larr; user mp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">start&larr;pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect&larr;newrect&larr;(Rectangle new origin: start corner: start).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection⇒ [selection highlite. self deselect. selection &larr; false.]]. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user anybug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rect&larr;newrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect comp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">t&larr;user mp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newrect&larr;(Rectangle new origin: (start min: t) corner: (start max: t)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect comp].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(rect width &lt; 10) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage smallestsubimageat:  pt- screenimage origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection  translate: screenimage origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection edit: screenimage.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection translate: ((0⌾0) - screenimage origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect origin &larr; screenimage griddedpoint: (rect origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; screenimage subimageswithin: <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(rect translate: ((0⌾0)- screenimage origin)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection translate: screenimage origin ; highlite]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">yellowbug | pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">documentmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒[self move];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒[self delete];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒[self place];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒[self cut];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=5⇒[self paste];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=6⇒[self copyselection];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=7⇒[self top];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=8⇒[self bottom];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=9⇒[self jump];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=10⇒[self addspace];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=11⇒[self deletespace];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=12⇒[self deselect. selection &larr; false. self show]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>FRAMING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">newframe<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self update.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fixedwidthfromuser: document width.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">show </span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self outline .<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">growing⇒[]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">titleframe put: (Paragraph new text: self title runs: titlerun alignment: 0)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">at: frame origin+titleloc; window outline; show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage  white.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage displayat: 0⌾0 effect: 1 clippedBy: self frame.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection ⇒ [ selection boxcomp].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">title </span><span style="font: 10pt serif">[ ⇑ document name] </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>EDITING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">addspace </span><span style="font: 10pt serif">| image i k r delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["add whitespace to the document  ."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update. selection &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; document rectanglefromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; (document indexofsubimagebelow: (r top- screenimage top) + documentwindow top).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[i⇒ </span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; r height.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ k from: i to: document length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(document◦k) translate: (0⌾(delta))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">document resize<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bottom </span><span style="font: 10pt serif">|  i delta <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["translate the current selection to the bottom of the window and update the document to reflect any changes in the subimages which are scrolled out of the screenimage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; (selection rectangle corner - screenimage rectangle corner).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update. selection &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">documentwindow translate: (0⌾ (delta y)). "move window on document"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"reconstruct screen image, including reestablishing  first and last indices"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">documentwindow &larr; Rectangle new origin:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(document rectangle corner-self frame height)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: (document width) ⌾ (self frame height).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">closeScrap<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrap ≡ nil⇒ []<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrap close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy </span><span style="font: 10pt serif">| <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["copy the selection and put it in scrap"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self copyselection<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copyselection </span><span style="font: 10pt serif">| <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["copy the selection and put it in scrap"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self closeScrap.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrap &larr; selection copy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame flash<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">cut </span><span style="font: 10pt serif">| t <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["delete subimage (paragraph) from the screenimage and save it in the scrap"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self closeScrap.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrap &larr; selection.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: selection do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">document bubbledelete: t.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame flash<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">delete | t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["delete subimage (paragraph) from the screenimage and save it in the scrap"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self closeScrap.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">scrap &larr; selection.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection highlite ;  display: 3.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: selection do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[screenimage delete: t<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame flash<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deletespace </span><span style="font: 10pt serif">| image i k r delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["delete whitespace from the document  ."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update. selection &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; document rectanglefromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; (document indexofsubimagebelow: (r top - screenimage top) + documentwindow top).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[i⇒ </span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; r height.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ k from: i to: document length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(document◦k) translate: (0⌾(0-delta))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">document resize<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deselect </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection translate: ((0⌾0) - screenimage origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: selection do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[t translate: selection origin<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">editTitle<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[titlepara&larr;document name asParagraph.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super editTitle.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document name: titlepara text]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">jump<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">|  y deltay yprime deltayprime rect pt newY scal r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user waitnobug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y &larr; document height.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">yprime &larr; frame height.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">deltay &larr; (documentwindow origin y) - (document  origin y).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scal&larr;yprime asFloat/y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">deltayprime &larr; (scal*deltay) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; ((screenimage leftside+((1.0-scal)*frame width/2))⌾((screenimage top) + deltayprime)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document quickDisplayAt: 0⌾0 scale: scal offset: (frame minX + ((1.0-scal)*frame width/2))⌾frame minY.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect&larr;0⌾0 rect: 1⌾1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect origin &larr; pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect corner x&larr;pt x +(scal*frame width) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect corner y&larr;pt y + (scal*frame height) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user cursorloc&larr;pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OriginCursor show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user redbug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[rect comp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user redbug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[r&larr;rect copy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newY&larr;user mp y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newY&lt;(frame minY- rect height) ⇒ [newY&larr;frame minY-rect height]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newY&gt;frame maxY ⇒ [newY&larr;frame maxY]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect translateto: pt x⌾newY.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r comp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect comp].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect comp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">deltayprime &larr; newY - (frame origin y).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">deltay &larr; y*deltayprime/yprime.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">documentwindow translateto: (0⌾deltay).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">move </span><span style="font: 10pt serif">| pt t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["used to place subimages (paragraphs) in the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[user waitnobug.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">OriginCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection highlite ; displayat: 0⌾0 effect: 3 clippedBy: frame.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user redbug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pt &larr;screenimage mp + screenimage rectangle origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection translateto: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection blink].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection displayat: 0⌾0 effect: 1 clippedBy: frame .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deselect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor show]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame flash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">paste </span><span style="font: 10pt serif">| </span><span style="font: bold 10pt serif">pt t</span><span style="font: 10pt serif"><br><br>["add the subimage (paragraph) in the scrap to the screenimage."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection⇒ [selection highlite]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; scrap copy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">OriginCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr;screenimage mp + screenimage rectangle origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection  translateto: pt ; blink<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection displayat: 0⌾0 effect: 1 clippedBy: self frame .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deselect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: selection do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">document bubbleinsert: (t translate: documentwindow origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">place </span><span style="font: 10pt serif">| pt tempimage t<br><br>["add the image in the scrap to the screenimage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection⇒[selection highlite]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deselect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; scrap copy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">OriginCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr;screenimage mp + screenimage rectangle origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection translateto: pt ; blink<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection  displayat: 0⌾0 effect: 1 clippedBy: self frame.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deselect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: selection do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">screenimage add: t.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">top </span><span style="font: 10pt serif">|  i delta <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["translate the current selection to the top of the window and update the document to reflect any changes in the subimages which are scrolled out of the screenimage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; (selection rectangle origin - screenimage rectangle origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update. selection &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">documentwindow translate: (0⌾ (delta y)). "move window on document"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> self buildscreenimage ; show. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"reconstruct screen image, including reestablishing  first and last indices"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self update.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">documentwindow &larr; Rectangle new origin: document rectangle origin<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: (document width) ⌾ (self frame height).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self buildscreenimage ; show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">update </span><span style="font: 10pt serif">|  i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["update the document to reflect any changes in the subimages ."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor topage1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[selection⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self deselect]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">document deleteI: firstindex to: lastindex. "update document"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: screenimage length  do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[document insert: <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(screenimage◦i translate: (0⌾documentwindow origin y)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">document resize.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪DocumentEditor under: &rsquo;FPI Packages&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">DocumentEditor classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"Heading"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Heading&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Image<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;formset index charactercodes currentcharacter&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;headingmenu &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["menu for the Heading edits."<br><br>headingmenu &larr; Menu new string:<br>&rsquo;right<br>left<br>up<br>down<br>font<br>&rsquo;.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin formset: formset currentcharacter: currentcharacter<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["initilization of a Heading (used in copy)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[formset is: Integer⇒ [ formset &larr; FormSet new fromstyle:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">DefaultTextStyle styleindex: formset.]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self origin: origin extent: (200⌾formset height).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin index: index charactercodes: charactercodes<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: bold 10pt serif">currentcharacter: currentcharacter | char w delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["initilization of a Heading (used in copy)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">formset &larr; FormSet new fromstyle:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">DefaultTextStyle styleindex: index.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ nil ≡ charactercodes ⇒ [ charactercodes &larr; Set new default]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self origin: origin extent: (200⌾formset height).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; origin copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: (0⌾0 - delta).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ char from: charactercodes do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: 10pt serif">char &larr; formset asForm: char.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addpath: w⌾0 andform: char.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; w + char width.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>EDIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">down | delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["move the current character down one bit."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self◦currentcharacter) translate: (0⌾1).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; origin copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self white ; display: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">edit: parentimage </span><span style="font: 10pt serif">| pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Simple Heading (line) editor for now."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self display: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ 1=2 do⦂ "forever for now"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user kbck⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ self typein ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user yellowbug ⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">headingmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self right]; "move current character right one bit"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self left]; "move current character left one bit"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self up]; "move current character up one bit"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self down]; "move current character down one bit"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=5⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self newfont] "change fonts"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug ⇒ </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(rectangle has: (pt&larr; user mp))⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pt &larr; pt - (rectangle origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">currentcharacter&larr; self indexofsubimageat: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">currentcharacter⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self◦currentcharacter displayat: self origin<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self◦currentcharacter displayat: self origin<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user bluebug ⇒ </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] "exit back to the parentimage" <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">left | i delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["move the current character and all those to the right of it to the left one bit."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: (currentcharacter to: self length) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ (self◦i) translate: (0⌾0) -(1⌾0) ].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; origin copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self white ; display: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">newfont </span><span style="font: 10pt serif">| w char charcount delta i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">index &larr;(user request: &rsquo;index of new font . .  &rsquo; ) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">formset &larr; FormSet new fromstyle: DefaultTextStyle styleindex: index.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self white.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: position do⦂ [ self◦i &larr; nil ].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">position &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">charcount &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; origin copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: (0⌾0 - delta).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ char from: charactercodes do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil≡ char ⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">char &larr; formset asForm: char.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">char displayat: delta+ (w⌾0) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addpath: w⌾0 andform: char.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; w + char width.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">charcount &larr; charcount+1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self resize.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">right | i delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["move the current character and all those to the right of it to the right one bit."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: (currentcharacter to: self length) do⦂ [ (self◦i) translate: (1⌾0) ].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; origin copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self white ; display: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">typein </span><span style="font: 10pt serif">| w char charcount delta i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self white.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: position do⦂ [ self◦i &larr; nil ].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">position &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">charcount &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">charactercodes &larr; Set new default.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; origin copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: (0⌾0 - delta).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ (char &larr; user kbd) = 13 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(char = 8) ⇒"back space" <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[charcount ≠  0 ⇒ [ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; w - ( (self◦charcount) width).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self◦charcount) white.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deleteimage: charcount.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">charactercodes deleteI: charcount.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">charcount &larr; charcount -1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">charactercodes add: char.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">char &larr; formset asForm: char.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">char displayat: delta+ (w⌾0) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addpath: w⌾0 andform: char.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; w + char width.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">charcount &larr; charcount+1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self resize.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">up | delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["move the current character up one bit."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self◦currentcharacter) translate: (0⌾0) - (0⌾1).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; origin copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: (0⌾0 - delta) ; resize ; translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self white ; display: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy </span><span style="font: 10pt serif">| h i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">h&larr; Heading new origin: (rectangle origin) copy index: index charactercodes: (charactercodes copy)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">currentcharacter: currentcharacter copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">h rectangle: rectangle copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">h add: (self◦i) copy <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ h<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromPress: press value:  s </span><span style="font: 10pt serif">| numberofcharacters  i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["retrieves and builds an instance of class Heading from a press file"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">numberofcharacters&larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">index &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">charactercodes &larr; Set new default.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: numberofcharacters do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ charactercodes add: s nextword ]</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self origin: origin index: index charactercodes: charactercodes<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">currentcharacter: 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hideData: complete </span><span style="font: 10pt serif">| s i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["stores an instance of class Heading on a press file"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; Stream new of: (String new: 100).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s nextword&larr; self length; "number of characters"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; index.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂ [s nextword &larr; charactercodes◦i].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ s contents]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">presson: press in: r </span><span style="font: 10pt serif">| hs y t i pressscale [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(hs  &larr; press scale*self height) &gt; r height⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"not enough room left on current page.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">assume for now that it will at least fit on an entire page"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self]<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self hidePress: press complete: ¬1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pressscale &larr; press scale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press selectfont: (press fontindex: 16*index style: DefaultTextStyle) - 1.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">press setx:  r leftside + ((self◦i) leftside*pressscale).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">press sety: r bottom - ((self◦i) top*pressscale).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">press showchar: (charactercodes◦i)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ r bottom - ((self height)*pressscale)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">printon: strm </span><span style="font: 10pt serif">| t [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm append: &rsquo;a Heading &rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Heading under: &rsquo;FPI Packages&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">Heading classInit</span></div>
<script>function do_tabs() { // unit = px
  var tabs = document.getElementsByClassName("tab");
  for (var i = 0; i < tabs.length; ++i) {
    var span = tabs[i];
    var val = span.getAttribute("val");
    if (val == null) console.log("Couldn't get val");
    var rect = span.getBoundingClientRect();
    var tabstop;
    if (val > 0) tabstop = Math.ceil(rect.left / val) * val;
    else tabstop = -val;
    console.log("do_tabs", val, tabstop)
    if (tabstop > 0) {
      var width = tabstop - rect.left;
      span.style.display = "inline-block";
      span.style.width = width + "px";
    }
  }
}
do_tabs();
</script>
  </body>
</html>
