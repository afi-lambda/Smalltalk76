<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>Smalltalk76/Form-Path-Image.st</title>
  </head>
  <body>
    <div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">&rsquo;From Smalltalk 5.5k XM November 24 on 5 February 2037 at 11:26:34 pm.&rsquo;<br></span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">"Form"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Form&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Object<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;extent bits offset figure ground&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;brush aurora black white aurorarunning SPARE color formmenu under reverse blankcursor over dotsetter &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class is a virtual bit map represented as a smalltalk String</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets up colors and effects for BITBLT."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">black &larr; 0-1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">white &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">over &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">under &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">reverse &larr; 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush &larr; Form new extent: 5⌾5. brush black.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">color &larr; 1.<br>formmenu &larr; Menu new string:<br>&rsquo;brush<br>black<br>white<br>line<br>arc<br>erase<br>size<br>figure<br>ground<br>&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter &larr; BitBlt new init." a BitBlt for pattern access."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter width &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter height &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurorarunning &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurora &larr; "Aurora new" nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent: extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["creates a virtual bit map with width = (extent x) and height = (extent y) with the bits all 1."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self extent: extent figure: 0 ground: 1 offset: (0⌾0).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent: extent figure: figure ground: ground offset: offset<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["creates a virtual bit map with width = (extent x) and height = (extent y) with the bits all 1."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits&larr; String new: 2*(extent y)*( ((extent x) +15) /16).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromImage: image <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["creates a virtual bit map with width = (image width) and height = (image height) with the bits in image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self extent: image extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits&larr; (image rectangle) bitsIntoString<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromrectangle: r <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["creates a virtual bit map with width = (r width) and height = (r height) with the bits in r."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self extent: r extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits&larr; r bitsIntoString<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span class="tab" val="79"></span><span style="font: bold 10pt serif">fromuser  | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["create a new Form whose rectangle is specified by the user. "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self extent: r extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits&larr; r bitsIntoString<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromuserevenword  | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["create a new Form whose rectangle is specified by the user,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">truncated to nearest multiple of 16 (for Spruce printing). "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new fromuserevenword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self extent: r extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits&larr; r bitsIntoString<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>PATTERN ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bits <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the string containing the bits)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ bits<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bits: bits <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["reset the string containing the bits)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">black </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets all bits in the form to black ( to ones)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: bits length do⦂ [ bits◦i &larr; 0-1]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">black: pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets the bit at pt in the  form to black ( to one)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(((0⌾0) ≤ pt) and⦂ (pt ≤ extent)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter destbase &larr; bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter destraster &larr; (extent x +15)/16.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter destx &larr; pt x.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter desty &larr; pt y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dotsetter fill: storing color: black<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">gray </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets all bits in the form to gray ( to gray)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: bits length do⦂ [ bits◦i &larr; 025252]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">white </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets all bits in the form to white ( to zeros)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: bits length do⦂ [ bits◦i &larr; 0]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>MODULE ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the extent (width⌾height) of the Form"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">figure<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the figure( color assiciated with black) for the form "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ figure<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">figure: figure <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["set the figure ( color assiciated with black) for the form "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ground <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the ground ( color assiciated with white) for the form "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ ground<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ground: ground <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["set the ground ( color assiciated with white) for the form "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">height <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the height of the Form"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ extent y<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">length </span><span style="font: 10pt serif">[ ⇑ bits length]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">offset <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the offset of the Form"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ offset<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">offset: offset <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["set the offset of the form "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">width <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the width of the Form"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ extent x<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>FILING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">read: filename </span><span style="font: 10pt serif">| f strip w h form stripheight leftoverlines i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Reads the Form from the disk in the format width,height,bits."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f&larr; (dp0 oldFile: filename).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f readonly.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">w &larr; (f nextword).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">h &larr;(f nextword).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent &larr; w⌾h.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">w*h &lt; 64000⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bits &larr; (Form new extent: extent) bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f into: bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f close.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f close.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;too many bits to be a Form&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">write: filename<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">Saves the Form in the format width,height,bits.</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(dp0 file: filename)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword&larr; (self width);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword&larr; (self height);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">append: bits;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">close.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">displayat:  path effect: effect clippedBy: cliprect</span><span style="font: 10pt serif">| r i clippedrect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["basic form display primitive"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path is: Point ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ r &larr; Rectangle new origin:  path extent: (self extent).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r bitsFromString: bits mode: effect clippedBy: cliprect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurorarunning⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user displayoffwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">clippedrect &larr; r intersect: (user screenrect).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurora destination: clippedrect ; source: clippedrect ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure: figure ; ground: ground ;  function: 002117 "AoverB" ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> doit; function: 0 ; doit.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path is: Path ⇒ [for⦂ i to: path length do⦂ [ self displayat: path◦i<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: effect clippedBy: cliprect] ]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asInstance </span><span style="font: 10pt serif">| s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s &larr; Stream new default.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s nextPoint&larr; extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s nextPoint&larr; offset.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s nextword &larr; figure.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s nextword &larr; ground.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s nextString &larr; bits.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ s contents <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return a copy of myself"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; Form new extent: extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t bits: bits copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromInstance: file <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent &larr;  file nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">offset &larr;  file nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure &larr; file nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ground &larr; file nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; file nextString.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromPress: press value: s </span><span style="font: 10pt serif">| nbytes [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent&larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">offset&larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ground &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">nbytes &larr; 2*(extent y)*((extent x + 15)/16).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(press data) skip: 0-nbytes.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; (press data) next: nbytes]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hideData: complete </span><span style="font: 10pt serif">| s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">a Form does not split across page boundaries</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Stream new of: (s &larr; String new: 12);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; extent;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; offset;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; figure;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; ground.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hidePress: press complete: c </span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑5]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">presson: press in: r </span><span style="font: 10pt serif">| hs y [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(hs  &larr; press scale*self height) &gt; r height⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"not enough room left on current page.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">assume for now that it will at least fit on an entire page"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self]<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press setp: (r origin x)⌾(y &larr; r corner y - hs);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmap: self bits: bits.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>EDITING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">arc: parentimage </span><span style="font: 10pt serif">| pt1 pt2 pt3 path pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["arc tool for forms."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt1 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt2 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt3 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt3 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path &larr; Path new init.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path addarcfrom: pt1 via: pt2 to: pt3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ pt from: path do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blinkbrush: parentimage </span><span style="font: 10pt serif">| pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["to show current position of brush in the form."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; parentimage mp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: (parentimage rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: (parentimage rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (parentimage rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">edit: parentimage </span><span style="font: 10pt serif">| pt f c file<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Simple Form editor for now."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ false do⦂ "forever for now"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[pt &larr; parentimage mp." blink the current brush"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self blinkbrush: parentimage.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug ⇒ </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ parentimage contains:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(pt &larr; self blinkbrush: parentimage)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[brush displayat: pt effect: color<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">clippedBy: parentimage rectangle.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user redbug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[brush displayat:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self blinkbrush: parentimage) effect: color<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">clippedBy: parentimage rectangle.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits&larr; (parentimage rectangle) bitsIntoString.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user kbck⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c &larr; user kbd. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c = 120⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ user clearshow: &rsquo;x gridding is &rsquo;. parentimage xgrid print.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user cr.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">parentimage xgrid:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(user request: &rsquo;x gridding . . . &rsquo;) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c = 121⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ user clearshow: &rsquo;y gridding is &rsquo;. parentimage ygrid print.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user cr.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">parentimage ygrid:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(user request: &rsquo;y gridding . . . &rsquo;) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c = 114⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">file &larr;(user request: &rsquo;filename of Form . . .&rsquo;) .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush &larr;Form new read: file. brush figure: 1  ; ground: 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user yellowbug ⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">formmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self newbrush: parentimage ]; "get a new brush"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[color &larr; 1.]; "set the color of the brush to black"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[color &larr; 3.]; "set the color of the brush to white"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self line: parentimage];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=5⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self arc: parentimage];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=6⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self white. parentimage display];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"erase the whole form"<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=7⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self resize: parentimage<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]; "change size"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=8⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self setfigure: parentimage];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=9⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self setground: parentimage]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user bluebug ⇒ </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bits&larr; (parentimage rectangle) bitsIntoString.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1. ⇑ self.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">] "exit back to the parentimage"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">line: parentimage </span><span style="font: 10pt serif">| pt1 pt2 path pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["line tool for forms."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BlankCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user redbug do⦂</span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt1 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt1 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ pt2 &larr; self blinkbrush: parentimage].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">brush displayat: pt2 effect: color clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path &larr; Path new init.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path addlinefrom: pt1 to: pt2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ pt from: path do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ brush displayat: pt effect: color clippedBy: user screenrect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">newbrush: superimage </span><span style="font: 10pt serif">|  pt rect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">OriginCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; ( superimage mp)+ superimage rectangle origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect &larr; pt rect: pt.</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rect reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">( superimage mp)+ superimage rectangle origin.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect corner &larr; (rect origin) max: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">brush &larr; Form new fromrectangle: rect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">resize: superimage </span><span style="font: 10pt serif">|  pt f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[superimage boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[superimage reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">superimage reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">( pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((superimage superimage) mp)+<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((superimage superimage) rectangle origin)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">superimage corner&larr; pt max: ((superimage origin) + (16⌾16)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">f&larr;Form new fromrectangle: superimage rectangle.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; f bits.<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">extent&larr; f extent .<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">offset &larr; 0⌾0.<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">superimage white ;<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">resize ; display ; boxcomp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">setfigure: parentimage </span><span style="font: 10pt serif">| <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"for now just increment the figure color by 1 \ 14"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure &larr; (figure +1 ) \ 14.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self displayat: (parentimage origin) effect: 0 clippedBy: user screenrect.<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">setground: parentimage </span><span style="font: 10pt serif">| <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"for now just increment the ground color by 1 \ 14"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ground &larr; (ground +1 ) \ 14.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self displayat: (parentimage origin) effect: 0 clippedBy: user screenrect.<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Form under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">Form classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"FormSet"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;FormSet&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Object<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;space spaceorigin image strike style styleindex formindex offsettable&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;imageindex bitmover &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>An object for holding sets of forms.  The most conventional use will be as a repository of a set of forms typically identified as characters when seen on the display or on paper.  The forms will be ascessible by passing a one-character<br>string or a number.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asForm: formindex</span><span class="tab" val="79"></span><span style="font: bold 10pt serif">  </span><span style="font: 10pt serif">| f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"returns the form indexed by formindex ."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self checkindex.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f &larr; Form new extent: (self width) ⌾ (self height) . <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; (f width + 15 / 16).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; (self originx). bitmover sourcey &larr;  0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; (f bits).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: storing.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">changeascentto: newascent</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"new ascent for FormSet"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deltaascent: (newascent - (self ascent))<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">changedescentto: newdescent</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"new ascent for FormSet"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deltadescent: (newdescent - (self descent))<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">changewidthof: formindex to: width</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"new width for form at index"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self checkindex. self deltawidthof: formindex by: (width - (self width))<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Just initialize the bitmover for now."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover &larr; BitBlt init</span><span style="font: italic 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy: formindex</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"> to: pt </span><span style="font: 10pt serif">| f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"copies the form indexed by formindex to pt."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self checkindex.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"f &larr; Image new size: (self width) ⌾ (self height) at: pt."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; ((user screenrect) width + 15 / 16).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; pt x. bitmover desty &larr; pt y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; (self originx). bitmover sourcey &larr;  0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; (mem◦ 066).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover strike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: oring.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self widthof: formindex<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy: formindex</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"> to: pt effect: effect </span><span style="font: 10pt serif">| f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"copies the form indexed by formindex to pt."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self checkindex.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"f &larr; Image new size: (self width) ⌾ (self height) at: pt."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; ((user screenrect) width + 15 / 16).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; pt x. bitmover desty &larr; pt y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; (self originx). bitmover sourcey &larr;  0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; (mem◦ 066).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover strike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: effect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copyrange: start to: stop from: sourceset startingat: deststart<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| savebackground savebits i f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"copy a range of forms from one set to another"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user displayoffwhile⦂<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[sourceset is: FormSet ⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourceset is: String ⇒ [sourceset &larr; FormSet new from: sourceset]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;Illegal sourceset -- not String or Formset.&rsquo;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">savebackground &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">Form new size: (sourceset maxwidth) by: (sourceset height).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">savebackground translate: 0⌾0; scale: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">savebits &larr; savebackground bitsIntoString.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: start to: stop do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[f &larr; sourceset copy: i to: 0⌾0. self include: deststart with: f.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">deststart &larr; deststart + 1].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">savebackground bitsFromString: savebits.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">currentformindex<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"return index of form last touched"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ formindex<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">currentformorigin |</span><span style="font: 10pt serif"> imageindex</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"return index in image of form last touched"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> imageindex &larr; image find: formindex.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ space ptofchar: imageindex.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">from: strike<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Make a formset out of string in strike format"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self classInit. self install: strike<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">from: first to: last ascent: ascent descent: descent<br></span><span class="tab" val="79"></span><span style="font: bold 10pt serif">style: style styleindex: styleindex name: name<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Make an empty formset."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self classInit.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">offsettable &larr; String new: (last - first + 3) * 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">offsettable all &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">offsettable word: (last - first + 3) &larr; 4.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"width of illegal form"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">String new: (9 </span><span style="font: italic 10pt serif">"header"</span><span style="font: 10pt serif"> + ascent + descent </span><span style="font: italic 10pt serif">"space for illegal form"</span><span style="font: 10pt serif">) * 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike all &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self type: 0100000.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"for the outside world"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self first: first.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self last: last.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self wordwidth: 1.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"only illegal form"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self ascent: ascent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self descent: descent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self maxwidth: 4.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"width of illegal form"</span><span style="font: 10pt serif"><br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike &larr; strike concat: offsettable ◦ (1 to: offsettable length).<br><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"mash in bits of illegal form"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"leftside"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; 1. bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover fill: storing color: black.<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"rightside"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; 3.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover fill: storing color: black.<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"top"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; 4. bitmover height &larr; 1. bitmover destx &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover fill: storing color: black.<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"bottom"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover desty &larr; (self ascent) + (self descent) - 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover fill: storing color: black.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self install: strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self updateseglength.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[style ≡ nil ⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">style setfont: styleindex name: name fromstring: strike]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromspace: pt to: dest<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"get form selected from space"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">formindex &larr; image ◦ ((space charofpt: pt) min: 256).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (self copy: formindex to: dest).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromstyle: style styleindex: styleindex<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Make a formset out of string in strike format"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self classInit. self install: style fonts◦(styleindex+1)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">height<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"return height of fromset"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self ascent + self descent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">include: formindex with: form </span><span style="font: 10pt serif">| newoffsettable newstrike i j<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Put a form into the formset"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(formindex &gt; (self first)) and:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(formindex &lt; (self last)) ⇒ [ self replace: formindex with: form]<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">formindex &lt; 0 ⇒ [user notify: &rsquo;Formindex &lt; 0 illegal for formset.&rsquo;]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">formindex &gt; 255 ⇒ [user notify: &rsquo;Formindex &gt; 255 illegal for formset.&rsquo;]<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[formindex &lt; (self first) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newoffsettable &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">String new: ((self first) - formindex + (self abslength)) * 2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newoffsettable all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">j &larr; (self first) - formindex + 1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i  from: j to: ((newoffsettable length) / 2) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newoffsettable word: i &larr; strike word: offsettable + (i-j)].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newoffsettable &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">String new: ((self abslength) + formindex - (self last)) * 2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newoffsettable all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: 0 to: ((self length) - 1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newoffsettable word: (i+1) &larr; strike word: offsettable + i].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: (self length) to: ((newoffsettable length) / 2) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newoffsettable word: i &larr; strike word: offsettable + self length].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newoffsettable word: ((newoffsettable length) / 2) &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: (offsettable + self length + 1).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr; String new: (9 </span><span style="font: italic 10pt serif">"header"</span><span style="font: 10pt serif"> + ((self wordwidth) *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self ascent + self descent)) </span><span style="font: italic 10pt serif">"bits"</span><span style="font: 10pt serif">)) * 2.</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"new space for bits"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: 9 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newstrike word: i &larr; strike word: i].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"fill in header of new font"</span><span style="font: 10pt serif"><br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (self strikerightx).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; newstrike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover strike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: storing.<br><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"copy the xtable"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike concat:  newoffsettable ◦(1 to: newoffsettable length).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self install: newstrike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[formindex &lt; (self first)  ⇒ [self first: formindex] self last: formindex].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self replace: formindex with: form.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">initspaceat: spaceorigin </span><span style="font: 10pt serif">| i run para<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"make a space for formset viewing"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">image &larr; String new: 256.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">image all &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: ((self first) to: (self last)+1)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">do⦂ [image◦(i+1) &larr; i].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">run &larr; String new: 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">run word: 1 &larr;  16 * (styleindex) + 0177400.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para &larr;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Paragraph new text: image runs: run alignment: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[space ≡ nil ⇒ [] space erase].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">space&larr; Textframe new para: para<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame: (Rectangle new origin: spaceorigin extent:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self last) - (self first) * (self maxwidth) / 8)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⌾<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self ascent) + (self descent) * 6))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">style: style.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">makecu: name scale: scale<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| f i iform bits drast srast<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Put out strike in Carnegie-Mellon format.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">A typical call might look like:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">yourset &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">FormSet new style: DefaultTextStyle styleindex: 0.<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">yourset makecu: &rsquo;cream12&rsquo; scale: 1.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user  displayoffwhile⦂<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f &larr; (dp0 file: name + &rsquo;.cu.&rsquo;).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f nextword &larr; self height * scale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f nextword &larr; self maxwidth * scale + 15 / 16.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits &larr; String new:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self height * scale) * ((self maxwidth * scale + 15)/16))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">* 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">drast &larr; self maxwidth * scale + 15 / 16.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">srast &larr; (user screenrect width) + 15/16.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: ((self first) to: (self last) by: 1) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[iform &larr; "self copy: i to: 0⌾0" self asForm: i. <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">iform displayat: (0⌾0) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[scale &gt; 1 ⇒ [iform blowup: 0⌾0 by: scale]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f nextword &larr; i. f nextword &larr; self width*scale.<br><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; bits.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; drast.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcebase &larr; mem◦066.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourceraster &larr; srast.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; false.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sstrike &larr; true.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (iform width) * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover height &larr; (iform height) * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">f append: bits].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f close.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">newspace<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"let user reshape/position space"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">space frame &larr; Rectangle new fromuser. self show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">replace: formindex with: form<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Replace form in set.  Check incoming form for compatibility with formset,<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">and insert form into formset."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self checkindex.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[form width ≠ self width ⇒ [self changewidthof: formindex to: form width]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form displayat: (0⌾0) effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"copy bits of form into formset"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; (self originx). bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (self width).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourceraster &larr; ((user screenrect) width + 15 / 16).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcebase &larr; (mem ◦ 066).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: storing.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">show<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"show all the forms in the set"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">space outline. space show<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">space<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"return textframe that is space of formset"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ space <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">spaceframe<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"return frame of space"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(space frame)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">spaceorigin: spaceorigin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"reposition the space"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">space erase. (space frame) origin &larr; spaceorigin. self show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">widthof: formindex<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"return width of from at formindex"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self width<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INTERNAL</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">abslength<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return absolute length of formset, i.e. number of forms in set<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">plus space for illegal character and its rightx"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ ((self last) - (self first) + 3)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">checkindex<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"check formindex for legality and make into number if necessary"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[formindex is: String ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[formindex length &gt; 1 ⇒ [user notify: &rsquo;formindex out of range for FormSet.&rsquo;]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">formindex &larr; formindex◦1]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(formindex &lt; (self first)) or: (formindex &gt; (self last+1)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user notify: &rsquo;formindex out of range for this FormSet.&rsquo;]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deltaascent: delta </span><span style="font: 10pt serif">| newstrike<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"ascent delta"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(self ascent) + delta &lt; 0 ⇒[delta &larr; 0 - (self ascent)]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[delta &gt; 0 ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"grow"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr; String new: (2 * (self wordwidth) * delta).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike all &larr;  0.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"fill with white"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr;</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"add oldfont header and new space together"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(strike◦(1 to: 18) concat: newstrike◦(1 to: newstrike length)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr;</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"now add on rest of old font"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(newstrike concat: strike◦(19 to: strike length)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"shrink"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr; (strike◦(1 to: 18) concat:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike◦((19 + (0 - (2 * (self wordwidth) * delta)))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">to: strike length)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike word: 6 &larr; ((self ascent) + delta).</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"reset ascent word in font"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self install: newstrike.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"newstrike now font of interest"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self updateseglength.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[style ≡ nil ⇒ [ ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(style maxascent) &lt; (self ascent) ⇒ [style maxascent: (self ascent)]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deltadescent: delta </span><span style="font: 10pt serif">| newstrike somespace<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"descent delta"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(self descent) + delta &lt; 0 ⇒ [ delta &larr; 0 - (self descent)]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[delta &gt; 0 ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[somespace &larr; String new: 2 * (self wordwidth) * delta.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">somespace all &larr; 0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(strike ◦ (1 to: offsettable - 1 * 2) concat: somespace).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(strike ◦ (1 to: ((offsettable - 1 * 2)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">+ ((self wordwidth) * delta * 2)))).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"copy the xtable"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike concat: strike ◦ ((offsettable * 2 - 1) to: strike length).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike word: 7 &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self descent) + delta).</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"reset descent word in font"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self install: newstrike.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"updatedfont now font of interest"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self updatemaxwidth.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self updateseglength.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[style ≡ nil ⇒ [ ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(style maxdescent) &lt; (self descent) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[style maxdescent: (self descent)]]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deltawidthof: index by: delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">| newwordwidth newoffsettable newstrike normalizedindex normalizedlast i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"change width of form at index"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[delta &lt; 0 ⇒ [(delta abs) &gt; (self width) ⇒ [delta &larr; 0-(self width)]]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newwordwidth &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[((self strikerightx) + 15 / 16) ≠<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(i &larr; ((self strikerightx) + delta + 15 / 16)) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ i ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self wordwidth)].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newoffsettable &larr; newwordwidth *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self ascent + self descent)) </span><span style="font: italic 10pt serif">"height"</span><span style="font: 10pt serif"> + 9 </span><span style="font: italic 10pt serif">"header"</span><span style="font: 10pt serif"> + 1 </span><span style="font: italic 10pt serif">"for 0 addressing"</span><span style="font: 10pt serif">.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">XeqCursor showwhile⦂ <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr; String new: (9 </span><span style="font: italic 10pt serif">"header"</span><span style="font: 10pt serif"> + (newwordwidth *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self ascent + self descent)) </span><span style="font: italic 10pt serif">"bits"</span><span style="font: 10pt serif">)) * 2.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"grow/shrink the bits"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike all &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: 8 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newstrike word: i &larr; strike word: i].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"fill in header of new font"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike word: 9 &larr; newwordwidth.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"set raster in new font"</span><span style="font: 10pt serif"><br><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"copy the xtable"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newstrike &larr; newstrike concat: strike◦((offsettable * 2 - 1) to: strike length).<br><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"set up to copy up to old bits of form in formset"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destraster &larr; newwordwidth.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; 0. bitmover desty &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; 0. bitmover sourcey &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (self originx) + (self width).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover height &larr; (self ascent) + (self descent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourceraster &larr; (self wordwidth).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destbase &larr; newstrike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcebase &larr; strike.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover dstrike &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: storing.<br><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"now copy remainder of font"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover destx &larr; (self originx) + (self width) + delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover width &larr; (self strikerightx) - (self originx) - (self width).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover sourcex &larr; (self originx) + (self width).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bitmover copy: storing.<br><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"shift x-vals"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">normalizedindex &larr; formindex - (self first).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">normalizedlast &larr; (self last) - (self first).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: ((normalizedindex + 1) to: (normalizedlast + 2 </span><span style="font: italic 10pt serif">"max"</span><span style="font: 10pt serif">)) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newstrike word: (newoffsettable+i) &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta + (newstrike word: (newoffsettable+i))].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self install: newstrike.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"set up the updated copy of the formset"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self updatemaxwidth.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self updateseglength. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">install: strike<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"set up a new or refreshed strike"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[style ≡ nil ⇒ [] style fonts ◦ (styleindex + 1) &larr; strike].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">offsettable &larr; (self wordwidth) *<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self ascent) + (self descent)) + 9 </span><span style="font: italic 10pt serif">"header"</span><span style="font: 10pt serif"> + 1 </span><span style="font: italic 10pt serif">"for 0 addressing"</span><span style="font: 10pt serif">.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ strike]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">length<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return length of formset, i.e. number of forms in set"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ ((self last) - (self first) + 1)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">originx<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return origin x  of form at formindex"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (strike word: (offsettable + formindex - (self first)))]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">updatemaxwidth </span><span style="font: 10pt serif">| newmaxwidth i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"update max width"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">newmaxwidth &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(offsettable to: offsettable + ((self last) - (self first) + 1))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[newmaxwidth &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(newmaxwidth<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">max: ((strike word: i+1) - (strike word: i)))].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self maxwidth: newmaxwidth.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">updateseglength<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"compute new segment length for formset"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 5 &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(5</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"length, ascent, descent, kern, and raster"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">+ ((self wordwidth) * ((self ascent) + (self descent)))</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"bits"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">+ ((self last "max") - (self first</span><span class="tab" val="79"></span><span style="font: 10pt serif">"min") + 2)</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"xtabl"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">width<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return width of form at formindex"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (strike word: (offsettable + (formindex - (self first)) + 1)) -<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(strike word: (offsettable + (formindex - (self first)))) ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>PARTS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ascent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"When form set treated as characters, describes distance from top of form<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">to baseline."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 6)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ascent: ascent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"When form set treated as characters, describes distance from top of form<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">to baseline."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 6 &larr; ascent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">descent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"When form set treated as characters, describes distance from bottom of<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">form to baseline."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 7)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">descent: descent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"When form set treated as characters, describes distance from bottom of<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">form to baseline."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 7 &larr; descent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">first<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Heritage from the world of fonts"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 2)</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"minimum formindex (ascii) in the strike"</span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">first: first<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Heritage from the world of fonts"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 2 &larr; first.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"minimum formindex (ascii) in the strike"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">kern<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"When form set treated as characters, describes distance this form is<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">to intrude into space of preceding character."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 8)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">last<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Heritage from the world of fonts"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 3)</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"maximum formindex (ascii) in the strike"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">last: last<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Heritage from the world of fonts"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 3 &larr; last.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"maximum formindex (ascii) in the strike"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">maxwidth<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"All forms in this set ≤ to this value"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 4)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">maxwidth: maxwidth<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"All forms in this set ≤ to this value"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 4 &larr; maxwidth.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">segmentlength<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Amount of space allocated for form set - 4"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 5)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">strikerightx<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Corner x of last form in form set"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: (offsettable + ((self last) - (self first)) + 2)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">type<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"**BEWARE -- outside world has ideas about this value."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 1)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">type: type<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"**BEWARE -- outside world has ideas about this value."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 1 &larr; type.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">wordwidth<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Also know as the raster of the formset.<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">The width in alto words of the bits of the formset.  When the display of a <br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">form is desired, the word and bit address of the bits of the form must<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">be discovered.  Adding the wordwidth to the word portion of that value,<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">produces the word address of the second line of the bits of the form, and<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">so on until the height of the form is spanned."</span><span style="font: 10pt serif"><br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(strike word: 9)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">wordwidth: wordwidth<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Also know as the raster of the formset.<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">The width in alto words of the bits of the formset.  When the display of a <br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">form is desired, the word and bit address of the bits of the form must<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">be discovered.  Adding the wordwidth to the word portion of that value,<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">produces the word address of the second line of the bits of the form, and<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">so on until the height of the form is spanned."</span><span style="font: 10pt serif"><br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strike word: 9 &larr; wordwidth.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪FormSet under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">FormSet classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"Image"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Image&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Set<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo; origin rectangle path form superimage xgrid ygrid figure ground&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;aurora under black screen reverse white over aurorarunning &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blink: form </span><span style="font: 10pt serif">| pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["to show current gridded position of the form... returns abs position."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; self mp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">form displayat: ( rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">form displayat: ( rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect: 2 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (self rectangle origin)+ pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["sets up black and white as colors and over ,under and reverse as modes<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">also initializes the name screen as an image the size of the display"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">black &larr; 0-1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">white &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">over &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">under &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">reverse &larr; 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">screen &larr; Image new origin: user screenrect origin extent: user screenrect extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurora &larr; "Aurora new" nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurorarunning &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromuser<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["create a new Image whose rectangle is specified by the user. "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr; Rectangle new fromuser.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self origin: (rectangle origin) rectangle: rectangle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">path: (rectangle origin) form: (Form new fromrectangle: rectangle)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure: 1 ground: 0 xgrid: 1 ygrid: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin extent: extent <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["create a new Image at origin with extent (width⌾height). "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self origin: (origin copy)  rectangle: (Rectangle new origin: origin extent: extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> path: nil form: nil figure: 1 ground: 0 xgrid: 1 ygrid: 1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin rectangle: rectangle path: path form: form<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["basic message to create a new instance."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self origin: origin rectangle: rectangle path: path form: form<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure: 1 ground: 0 xgrid: 1 ygrid: 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin rectangle: rectangle path: path form: form figure: figure ground: ground xgrid: xgrid ygrid: ygrid<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["basic message to create a new instance."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self default]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rectanglefromuser | f pt r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["create a  Rectangle  specified by the user and origin and corner are gridded. "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">f &larr; Form new extent: xgrid⌾ygrid. f black.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitnobug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user anybug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r origin &larr; self blink: f.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r corner &larr; (self mp + rectangle origin) max: (r origin + f extent).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r reverse ; reverse.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ r.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>BUILDING IMAGES</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">add: p and: i | s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["add p (set or point) and i ( Image or Form ) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((Rectangle new origin: (p origin)+ origin extent: i size)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">include: (Rectangle new origin: (p corner)+ origin extent: i size)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; Set default. s add: p ; add: i .<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self add: s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">addform: f andpath: p | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["add p (set or point) and f ( Form ) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addpath: p andform: f<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">addimage: i  | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["add the Image i (as a subimage) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(Rectangle new origin: (i origin)+ origin extent: i extent).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self add: i.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">addpath: p andform: f | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["add p (set or point) and f ( Form ) and expand the<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> bounding rectangle of this image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(r &larr; ((Rectangle new origin: (p origin)"+ origin" extent: f extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">include:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(Rectangle new origin: ((p corner) - (1⌾1))"+ origin" extent: f extent))).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self add: (Image new origin: 0⌾0 rectangle: r path: p form: f<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure: 1 ground: 0 xgrid: 1 ygrid: 1).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>CHANGING IMAGES</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">appendimage: newimage after: image </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["append newimage into the image after image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; self findbyrect: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self insertI: (i+1) value: newimage.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">comment<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["see class Set for operations (deletion,replacement,insertion etc.) on subimages ( elements)."]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deleteimage: i | subimage<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["delete the i th subimage and recompute the bounding rectangle of the Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">subimage &larr; self◦i.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deleteI: i.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">( subimage rectangle) isWithin: rectangle⇒ [] self resize "recompute bounding rectangle"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deletesubimage: i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["delete the ith subimage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self deleteindex: i.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">edit: superimage | </span><span style="font: 10pt serif">blackdot pt indexofsubimage subimage</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["eventually a general Image manipulator for now<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">just passes control to its subimages."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">nil≡ form ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user waitnobug.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ (1 = 2) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"> "until bug occurs outside rectangle"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((false = (rectangle has: (user mp))) and: (user anybug))⇒[⇑ self ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user kbck ⇒ [ self kbd ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[indexofsubimage &larr; self smallestsubimageat:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">( (user mp) - self rectangle origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">indexofsubimage⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ subimage &larr; self◦indexofsubimage.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">subimage translate: self origin .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">subimage edit: self.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">subimage translate: ((0⌾0)-self origin).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user yellowbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self yellowbug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form &larr; form edit: self.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[form is: Form⇒ [] "origin &larr;  (form origin) copy." rectangle &larr; (form frame) copy].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">findbyrect: image </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: position do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(array◦i) rectangle = image rectangle ⇒ [⇑i]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑0]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">highlite  | r i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["reverse the ith subimage ."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: position do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new origin: (self origin+ (self◦i) origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: (self◦i) extent.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">r comp<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">indexofsubimageat: pt | i subimage <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the index of the subimage which contains pt(relative to self origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">otherwise return false."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[subimage &larr; (self◦i).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(subimage rectangle) has: pt⇒ [ ⇑ i]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ false<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">indexofsubimagebelow: yvalue | i subimage <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the index of the first subimage below yvalue otherwise return false."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ ((self◦i) top ≥ yvalue) ⇒ [ ⇑ i]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ false<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">outlinesubimage: i  | r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["draw an outline(reversed boarder 2 units thick) about the ith subimage ."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new origin: (self origin+ (self◦i) origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: (self◦i) extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r comp<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">replaceimage: image with: newimage </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["replace image with newimage in self."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; self findbyrect: image.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self replaceI: i value: newimage.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">smallestsubimageat: pt | i smallest slf sml<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the index of the smallest subimage which contains pt(relative to self origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">otherwise return false."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">smallest &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((self◦i) rectangle) has: pt⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">smallest⇒[ slf&larr;((self◦i) rectangle).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">sml&larr;((self◦smallest) rectangle).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(slf area &lt; sml area) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[smallest &larr; i]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">  ]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">smallest &larr; i<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">smallest⇒[⇑ self◦smallest]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ smallest</span><span style="font: bold italic 10pt serif"> </span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">subimage: i | sub s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the ith subimage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">sub &larr; (self◦i)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; Image new at: (self origin) + (sub◦1) origin. s add: (0⌾0) and: sub◦2. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">subimageat: pt | i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the  subimage which contains pt (relative to self origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">otherwise return false."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; self indexofsubimageat: pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i ⇒ [ ⇑ self◦ i]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ false<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">subimageswithin: rect | image topleft fittedimage t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return an image containing my subimages that are within rect, </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">otherwise return false."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">image &larr; Image new origin: rect origin extent: rect extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: self do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(t rectangle) isWithin: rect⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">image addimage: (t translate: (0⌾0)-(rect origin))<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">image length = 0⇒[⇑ false]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">topleft &larr; (image◦1) rectangle origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: image do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(t rectangle origin) &lt; topleft⇒ [topleft &larr; (t rectangle origin)]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">fittedimage &larr; Image new origin: (topleft+rect origin) extent: (1⌾1).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: image do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ fittedimage addimage: (t translate: (0⌾0)-topleft)].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ fittedimage</span><span style="font: bold italic 10pt serif"> </span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">substitute: form1 for: form2 </span><span style="font: 10pt serif">| i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["everywhere in the imagesubstitute form1 for form2"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂ [ (self◦i)◦2 ≡ form2 ⇒  [ (self◦i)◦2 &larr; form1]]  <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blink <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["blink the image" <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self display: 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self display: 2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">display <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["display all of the forms in the image on the screen "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self displayat: 0⌾0 effect: 0 clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">display: effect  <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["display all of the forms in the image on the screen <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect = 0 ⇒ store<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect = 1 ⇒ or<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect = 2 ⇒ xor<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">effect = 3 ⇒ and complement<br>"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self displayat: 0⌾0 effect: effect clippedBy: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">displayat: pt effect: effect clippedBy: cliprect </span><span style="font: 10pt serif">| i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["display all of the subimages in this image "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil≡ form</span><span class="tab" val="79"></span><span style="font: 10pt serif">⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">form displayat: (path + pt+ origin) effect: effect clippedBy: cliprect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ (self◦i) displayat: (pt +  origin) effect: effect clippedBy: cliprect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">quickDisplayAt: pt scale: scal offset: delta </span><span style="font: 10pt serif">| i rect x1 y1 x2 y2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["outline me and all of the subimages in this image in given scale"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">x1&larr; (scal*(rectangle minX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y1&larr; (scal*(rectangle minY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">x2&larr; (scal*(rectangle maxX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y2&larr; (scal*(rectangle maxY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect &larr; x1⌾y1 rect: x2⌾y2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect outline.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pt &larr; pt+origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rect &larr; (self◦i) rectangle.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">x1&larr; (scal*(rect minX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">y1&larr; (scal*(rect minY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">x2&larr; (scal*(rect maxX + pt x) + delta x) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">y2&larr; (scal*(rect maxY + pt y) + delta y) asInteger.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect &larr; x1⌾y1 rect: x2⌾y2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect color: gray mode: oring.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>MODULE ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">= image<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑(rectangle = (image rectangle))<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bottom<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the bottom y of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle corner y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">center<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the center of the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle center.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">contains: pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return true if the  bounding rectangle for the Image contains pt.."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle has: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">corner<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the corner of the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle corner.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">corner&larr; pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["modify the corner of the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> rectangle corner&larr; pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the extent (width,height) of the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">height<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the height of the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle extent y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">leftside<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the leftmost x of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle origin x.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the origin of the image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ origin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["change the origin of the image."]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rectangle <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the rectangle that bounds the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rectangle: r <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["redefine rectangle that bounds the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle&larr; r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">resize | i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[" Recompute the bounding rectangle of the Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil≡ form</span><span class="tab" val="79"></span><span style="font: 10pt serif">⇒ [rectangle &larr; Rectangle new origin: origin extent: 1⌾1]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr; Rectangle new origin: origin extent: form extent].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ rectangle  &larr; rectangle include: ((self◦i) rectangle) ]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rightside<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the rightmost x of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle corner x.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">superimage<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the superimage (Image containing) of this Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ superimage<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">top<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the top y of the bounding rectangle of theImage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle origin y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">width<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the width of the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ rectangle extent x.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>PATTERN ACCESS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">black<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["black out the image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self color: black effect: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">boxcomp <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["border without disturbing the interior."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle comp<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">color: color effect: effect <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["basic rectangle call to blt."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle color: color mode: effect .<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurorarunning⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[user displayoffwhile⦂ [aurora destination: rectangle ; source: rectangle ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure: figure ; ground: ground ;  function: 002117 "AoverB" ; doit<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]]<br> ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">gray<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["gray out the image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self color: gray effect: storing<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">reverse<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["reverse  the image (black to white and white to black)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self color: black effect: 2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">white <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["white out the image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form is: BorderedText⇒ [ (rectangle inset: (¬1⌾¬1) and: (¬1⌾¬1)) clear: 0]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self color: white effect: over.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>TRANSFORMATIONS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">griddedpoint: pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ ((pt x)| xgrid) ⌾ ((pt y)| ygrid) ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">normalize | delta i <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["recompute origin, rectangle and path so that: path origin = 0⌾0."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil ≡ path ⇒ [] delta &larr; (path origin) copy. path normalize. origin translate: delta]. </span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂ [ (self◦i) normalize ].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">translate: delta <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["translate the origin and bounding rectangle of the Image."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr; rectangle translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin translate: delta.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">translateto: pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["move the Image to pt."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self translate: pt - origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy </span><span style="font: 10pt serif">| im i<br>[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">im &larr; Image new origin: origin copy rectangle: rectangle copy path: path copy form: form copy figure: figure copy ground: ground copy xgrid: xgrid copy  ygrid: ygrid copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[im add: (self◦i) copy].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ im<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromPress: press value: s </span><span style="font: 10pt serif">| numberofsubimages i code t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">retrieves and builds an instance of class Image from a press file</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self default. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">numberofsubimages&larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">i &larr; s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rectangle &larr; i rect: s nextPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">xgrid &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ygrid &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ground &larr; s nextword.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form &larr; s next.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path &larr; s next.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: numberofsubimages do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; press nextControl asStream.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">code &larr; s next.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; Image new.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">code = t pressCode⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self addimage: (t fromPress: press value: s)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;subimage not Image&rsquo;].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[form=0⇒ [form &larr; nil]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; press nextControl asStream.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">code &larr; s next.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form &larr; [code = 4⇒ [TextImage new]; =5⇒ [Form new]; = 6 ⇒[BorderedText new] false].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form and⦂ code = form pressCode⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[code=4⇒ [form frame &larr; rectangle copy]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[code=6⇒ [form frame &larr; rectangle copy]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">form fromPress: press value: s]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;illegal form&rsquo;].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[path=0⇒ [path &larr; nil]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; press nextControl asStream.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">code &larr; s next.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path &larr; [code = 6⇒ [Path new]; =7⇒ [Point new] false].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">path and⦂ code = path pressCode⇒ [path fromPress: press value: s]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;illegal path&rsquo;]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hideData: complete </span><span style="font: 10pt serif">| s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">stores an instance of class Image on a press file. ignore complete</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Stream new of: (s &larr; String new: 24);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword&larr; self length; "</span><span style="font: italic 10pt serif">number of subimages</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; rectangle origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextPoint&larr; rectangle corner;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword&larr; xgrid;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; ygrid;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; figure;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; ground;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">next &larr; [form≡nil ⇒ [0] 1];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">next &larr; [path≡nil⇒ [0] 1].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hidePress: press complete: c </span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c ≥ 0⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">called from </span><span style="font: bold 10pt serif">PressPrinter print:in:</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[form≡nil⇒ ["</span><span style="font: italic 10pt serif">already done</span><span style="font: 10pt serif">"]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">form hidePress: press complete: c].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">path≡nil⇒ []<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">path hidePress: press complete: c]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">¬1. called from </span><span style="font: bold 10pt serif">Image presson:in:</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">kbd | <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[" default response for Images."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user kbd.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reverse ; reverse.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">mp | p<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[" returns a gridded point relative to my rectangle."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p &larr; user mp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p x&larr; ((p x) - rectangle origin x) | xgrid. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p y&larr; ((p y) - rectangle origin y) | ygrid.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ p<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">presson: press in: r </span><span style="font: 10pt serif">| yvalue t h rect [</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self length &gt; 0 and⦂ r height &lt; (h &larr; press scale * self height)⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">try on next page</span><span style="font: 10pt serif">" ⇑self]<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self hidePress: press complete: ¬1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: self do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">yvalue &larr;  t presson: press in: r.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">if subimage didn&rsquo;t fit, print version will be clipped,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">but entire subimage will be stored</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">t hidePress: press complete: [yvalue is: Integer⇒ [0] 1]].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form≡nil⇒ [⇑r corner y - h]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect &larr; r copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rect corner y &larr; rect corner y - (( path y)*(press scale)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">form will be hidden by Image presson:in: or PressPrinter print:in:</span><span style="font: 10pt serif">".<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑form presson: press in: rect]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">printon: strm </span><span style="font: 10pt serif">| t [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm append: &rsquo;an Image: &rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">array is: String⇒ [strm space append: self]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: self do⦂ [strm space print: t]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ACCESS TO PARTS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">figure<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the figure color (color associated with black) for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ figure<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">figure: figure <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["change the figure color (color associated with black) for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">form <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the form for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ form<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">form: form <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["change the form for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ground<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the ground color (color associated with white) for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ ground<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ground: ground <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["change the ground color (color associated with white) for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hash </span><span style="font: 10pt serif">[⇑rectangle hash]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">path <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the path for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ path<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">path: path<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["change the path for this Image"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">superimage: superimage </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">xgrid <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the x gridding module for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ xgrid<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">xgrid: xgrid <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["set the x gridding module for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ygrid <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the y gridding module for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ ygrid<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ygrid: ygrid <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["set the y gridding module for this Image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Fist and last</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">| im<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[[array≡nil<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇒[]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ im  from: self asArray notNil do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[im close]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">superimage&larr;nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">form&larr;nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self vector: 0]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Image under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">Image classInit</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"Path"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Path&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Set<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">init <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["must be executed for each new instance."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self default.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>BUILDING PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">comment <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["see Set for these ... add:, append:, and ◦&larr; are the main ones"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ACCESSING PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pointnearestto: p </span><span style="font: 10pt serif">| distance i nearest d<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the index of the point  in the path nearest (manhatten norm) to p."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">distance &larr; p dist: self◦1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">nearest &larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: position do⦂ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: 10pt serif">d &larr;  p dist: self◦i .<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">d&lt; distance⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ nearest&larr; i. distance &larr; d.]  <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ nearest<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>MODIFYING PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">deleteindex: i </span><span style="font: 10pt serif">| r [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; array◦( i+1 to: position).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">position &larr; i-1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self append: r.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">array◦(position+1) &larr; nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">insert: pt atindex: index </span><span style="font: 10pt serif">| r <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"insert pt at index in the path"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">index &gt; position⇒ [self next &larr; pt]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; [position = limit⇒ [self grow] self growby: 0].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">position &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self append: (r ◦ 1 to: index-1);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">next &larr; pt;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">append: r◦(index to: r length).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SPECIAL PATHS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">addarcfrom: p1 via: p2 to: p3 </span><span style="font: 10pt serif">| pa pb i k s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Kaehler method for Flegal curve"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s&larr; Path new init. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s add: p1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">pa&larr; p2-p1. pb&larr; p3-p2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">k&larr; 5 max: (pa x abs + pa y abs + pb x abs + pb y abs)/20.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: k do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"k is a guess how many segments are appropriate"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s add: (pa*i/k+p1*(k-i)) + (pb*(i-1)/k+p2*(i-1)) / (k-1)]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s add: p3 .<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: (s length-1) do⦂ [  self addlinefrom: s◦i to: s◦(i+1) ] <br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">addlinefrom: p1 to: p2 |</span><span style="font: 10pt serif"> x1 y1 dx dy yinc x0 y0 cdl i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"for now just add points to the space at alto resolution between p1 and p2<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">inclusive"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dx&larr; ( p2 x) - (p1 x).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dy&larr; ( p2 y) - (p1 y).<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dx &lt; 0 ⇒ [dx &larr; 0-dx. dy &larr; 0-dy. x0&larr; p2 x. y0 &larr; p2 y]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">x0 &larr; p1 x. y0 &larr; p1 y].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dy ≥ 0 ⇒ [yinc&larr;1] yinc &larr; 0-1 . dy &larr; 0-dy].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> dx≥dy⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[cdl &larr; ( dx/2).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: 0 to: dx do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self add: (x0⌾y0). cdl &larr; cdl + dy.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">x0 &larr; x0+1. <br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">cdl &gt; dx⇒ [cdl &larr; cdl - dx. y0 &larr; y0 + yinc]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"y is fastest mover"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">cdl &larr; (dy/2).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: 0 to: dy do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self add: (x0⌾y0) . cdl &larr; cdl+ dx.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">y0 &larr; y0 + yinc.  <br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> cdl &gt; dy ⇒ [cdl &larr; cdl - dy. x0&larr; x0+1]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]. <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>TRANSFORMATIONS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">+ delta </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ "add delta to every point in the path"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (self copy) translate: delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">normalize </span><span style="font: 10pt serif">| delta i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ "subtract the origin of the path from every point in the path"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">delta &larr; self origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ self◦i &larr; self◦i - delta<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">scale: factor </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ "scale every point in the path by factor"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ self◦i &larr; self◦i * factor<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">translate: delta </span><span style="font: 10pt serif">| i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ "add delta to every point in the path"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length  do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ self◦i &larr; self◦i + delta<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>MEASURING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">corner <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the corner of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (self rectangle) corner<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the extent of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (self rectangle) extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">height <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the height of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self size y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the origin of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (self rectangle) origin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rectangle | r  i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new origin: self◦1 extent: 1⌾1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: self length do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ r &larr; r include: self◦i</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">size <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the extent of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (self rectangle) extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">width <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the width of the bounding rectangle that includes all the points in the path."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ self size x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy  | t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["returns a new instance of Path that is a copy "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; Path new init.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t append: (array◦(1 to: position)) copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ t]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑6]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">printon: strm </span><span style="font: 10pt serif">| t [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm append: &rsquo;a Path: &rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">array is: String⇒ [strm space append: self]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ t from: self do⦂ [strm space print: t]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Path under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"Point"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Point&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Object<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;x y&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am an x-y pair of numbers usually designating a location on the screen</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ (x⌾y)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">x: x y: y</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Arithmetic</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">≤ pt </span><span style="font: 10pt serif">[⇑ x≤pt x and⦂ y≤pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">≥ pt </span><span style="font: 10pt serif">[⇑ x≥pt x and⦂ y≥pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">* scale<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return a Point that is the product of me and scale (which is a Point or Number)"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Point new x: (x * scale asPtX) y: (y * scale asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">+ delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return a Point that is the sum of me and delta (which is a Point or Number)"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Point new x: (x + delta asPtX) y: (y + delta asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">- delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return a Point that is the difference of me and delta (which is a Point or Number)"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Point new x: (x - delta asPtX) y: (y - delta asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">/ scale<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return a Point that is the quotient of me and scale (which is a Point or Number)"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Point new x: (x / scale asPtX) y: (y / scale asPtY)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">&lt; pt </span><span style="font: 10pt serif">[⇑ x&lt;pt x and⦂ y&lt;pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">= pt </span><span style="font: 10pt serif">[⇑x=pt x and⦂ y=pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">&gt; pt </span><span style="font: 10pt serif">[⇑x&gt;pt x and⦂ y&gt;pt y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">abs</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"absolute value of a point"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Point new x: (x abs) y: (y abs)</span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dist: pt </span><span style="font: 10pt serif">| t</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"distance (Manhattan norm) between pt and self"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[t &larr; (pt - self) abs.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑(t x) + (t y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">length<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑((x asFloat*x asFloat)+(y asFloat*y asFloat)) sqrt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">max: t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Point new x: (x max: t x) y: (y max: t y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">min: t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Point new x: (x min: t x) y: (y min: t y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">normal </span><span style="font: 10pt serif">| n</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"unit vector rotated 90 deg clockwise"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[n&larr; y asFloat neg ⌾ x asFloat.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑n/n length]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">normalize <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"set selt to zero"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self x &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self y &larr; 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">translate:  delta<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"increment self by delta"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">x &larr; x + delta x.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">y &larr; y + delta y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">| grid<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Point new x: x|grid y: y|grid]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Conversion</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asPoint<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return self."</span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asPtX<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asPtY<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑y ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asRectangle<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return a Rectangle with me as both origin and corner."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self rect: self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asRectCorner </span><span style="font: italic 10pt serif">"pretend to be a Rectangle for Rectangle +-*/"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asRectOrigin </span><span style="font: italic 10pt serif">"pretend to be a Rectangle for Rectangle +-*/"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">corner<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ self+ (1⌾1)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ (1⌾1)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent: p</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"infix creation of rectangles"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Rectangle new origin: self extent: p]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">height<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ self]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">printon: strm <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[strm print: x; append: &rsquo;⌾&rsquo;; print: y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rect: p</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"infix creation of rectangles"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Rectangle new origin: self corner: p]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">width<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Access to parts</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hash </span><span style="font: 10pt serif">[⇑(x lshift: 2) lxor: y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">theta </span><span style="font: 10pt serif">| tan theta "return the angle the point makes with origin.  right is 0; down is 90."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[x=0 ⇒ [y≥0 ⇒ [⇑ 90.0] ⇑ 270.0].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> tan &larr; y asFloat/x asFloat.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> theta &larr; tan arctan.<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> x≥0 ⇒ [y≥0 ⇒[⇑ theta] ⇑360.0 + theta].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> ⇑ 180.0 + theta]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">x</span><span class="tab" val="79"></span><span style="font: bold 10pt serif"> </span><span style="font: 10pt serif">[⇑x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">x &larr; x</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">y </span><span style="font: 10pt serif">[⇑y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">y &larr; y</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromPress: press value: s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ x &larr; s nextword. y &larr; s nextword]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hideData: complete </span><span style="font: 10pt serif">| s<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[Stream new of: (s &larr; String new: 4); nextPoint&larr; self.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hidePress: press complete: c<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑7]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Point under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"Rectangle"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;Rectangle&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Object<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;origin corner&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;&rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>I am a pair of points, usually representing a rectangular area on the screen</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Initialization</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy  <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["new rectangle"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ (origin copy) rect: (corner copy)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromuser </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Show the origin cursor until the user presses a mouse button,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">then get my origin"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin&larr;OriginCursor showwhile⦂ [user waitbug].<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"Show the corner cursor and complement me until the user presses<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">a button again.  The loop is arranged so <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">that complementing stays on for a little while."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t&larr;origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CornerCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[while⦂ [corner&larr;t.  t &larr; user mpnext] do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self comp.  t &larr; t max: origin.  self comp]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromuserevenword </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Show the origin cursor until the user presses a mouse button,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">then get my origin"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin&larr;OriginCursor showwhile⦂ [user waitbug].<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"Show the corner cursor and complement me until the user presses<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">a button again.  The loop is arranged so <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">that complementing stays on for a little while."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t&larr;origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CornerCursor showwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[while⦂ [corner &larr; t.  t &larr; user mpnext] do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self comp.  t &larr; (((t x) + 15 | 16) ⌾ t y) max: origin.  self comp]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin corner: corner</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin: origin extent: extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[corner &larr; origin+extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Aspects</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">area </span><span style="font: 10pt serif">[⇑(self width)*(self height)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bottom </span><span style="font: 10pt serif">[⇑corner y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">corner </span><span style="font: 10pt serif">[⇑corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">corners </span><span style="font: 10pt serif">| v<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[v&larr; Vector new: 4.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">v◦1&larr; origin. v◦2&larr; corner x⌾ origin y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">v◦3&larr; corner. v◦4&larr; origin x⌾corner y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑v]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">corner &larr; corner</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">edge: side </span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">Returns one side as a number.</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">Sides are numbered 0-3.  +1 goes counterclockwise.  lxor: 2 gets opposite side.</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=0⇒["top" ⇑origin y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒["left" ⇑origin x];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒["bottom" ⇑corner y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒["right" ⇑corner x].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑corner-origin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">extent &larr; extent<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[corner &larr; origin+extent. ⇑extent]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hash </span><span style="font: 10pt serif">[⇑(origin lshift: 1) lxor: corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">height<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑corner y - origin y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">height &larr; h </span><span style="font: italic 10pt serif">"change my bottom y to make my height h"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[corner y &larr; origin y + h]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">leftside </span><span style="font: 10pt serif">[⇑origin x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">maxX </span><span style="font: 10pt serif">[⇑corner x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">maxY </span><span style="font: 10pt serif">[⇑corner y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">minX </span><span style="font: 10pt serif">[⇑origin x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">minY </span><span style="font: 10pt serif">[⇑origin y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin </span><span style="font: 10pt serif">[⇑origin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">origin &larr; origin</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rightside </span><span style="font: 10pt serif">[⇑corner x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">side: side </span><span style="font: italic 10pt serif">"Returns one side as a rectangle."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"Sides are numbered 0-3.  +1 goes counterclockwise.  Xor: 2 gets opposite side."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=0⇒[</span><span style="font: italic 10pt serif">"top"</span><span style="font: 10pt serif"> ⇑origin rect: corner x⌾origin y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒[</span><span style="font: italic 10pt serif">"left"</span><span style="font: 10pt serif"> ⇑origin rect: origin x⌾corner y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒[</span><span style="font: italic 10pt serif">"bottom"</span><span style="font: 10pt serif"> ⇑origin x⌾corner y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒[</span><span style="font: italic 10pt serif">"right"</span><span style="font: 10pt serif"> ⇑corner x⌾origin y rect: corner].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">size<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑corner-origin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">top </span><span style="font: 10pt serif">[⇑origin y]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">width<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑corner x - origin x]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">width &larr; w </span><span style="font: italic 10pt serif">"change my right x to make my width w"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[corner x &larr; origin x + w]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">withEdge: side at: coord </span><span style="font: 10pt serif">"Returns a rectangle with one side moved."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=0⇒ [⇑origin x⌾coord rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ [⇑coord⌾origin y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒ [⇑origin rect: corner x⌾coord];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒ [⇑origin rect: coord⌾corner y].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">withSide: side at: pt </span><span style="font: italic 10pt serif">"Returns a rectangle with one side moved."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=0⇒ [⇑origin x⌾pt y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ [⇑pt x⌾origin y rect: corner];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒ [⇑origin rect: corner x⌾pt y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒ [⇑origin rect: pt x⌾corner y].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Arithmetic</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">* scale </span><span style="font: 10pt serif">[<br></span><span style="font: italic 10pt serif">"Return a Rectangle which is the product of me and scale (which is a Rectangle, Point, or Number)"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Rectangle new origin: origin * scale asRectOrigin corner: corner * scale asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">+ delta </span><span style="font: 10pt serif">[<br>"</span><span style="font: italic 10pt serif">Return a Rectangle which is the sum of me and delta (which is a Rectangle, Point, or Number)"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Rectangle new origin: origin + delta asRectOrigin corner: corner + delta asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">- delta </span><span style="font: 10pt serif">[<br></span><span style="font: italic 10pt serif">"Return a Rectangle which is the difference of me and delta (which is a Rectangle, Point, or Number)"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Rectangle new origin: origin - delta asRectOrigin corner: corner - delta asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">/ scale </span><span style="font: 10pt serif">[<br></span><span style="font: italic 10pt serif">"Return a Rectangle which is the quotient of me and scale (which is a Rectangle, Point, or Number)"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Rectangle new origin: origin / scale asRectOrigin corner: corner / scale asRectCorner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">= r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑origin = r origin and: corner = r corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">center<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑origin+corner/2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">empty<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑(origin &lt; corner)≡false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">has: pt </span><span style="font: 10pt serif">[⇑origin ≤ pt and⦂ pt &lt; corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">include: r </span><span style="font: italic 10pt serif">"Returns the merge with an adjacent rectangle."</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑(origin min: r origin) rect: (corner max: r corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">inset: p1<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑origin+p1 rect: corner-p1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">inset: p1 and: p2<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑origin+p1 rect: corner-p2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">intersect: r </span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑Rectangle new origin: (origin max: r origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">corner: (corner min: r corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">intersects: r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑(origin max: r origin) &lt; (corner min: r corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">isWithin: rect</span><span style="font: bold italic 10pt serif">  </span><span style="font: italic 10pt serif">"am I equal to or contained within rect"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑origin ≥ rect origin and⦂ corner ≤ rect corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">max: rect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin: (origin min: rect origin)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">corner: (corner max: rect corner)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">minus: r </span><span style="font: 10pt serif">| s yorg ycor</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"return Vector of Rectangles comprising<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">the part of me not intersecting r "</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Make sure the intersection is non-empty"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[origin≤r corner and⦂ r origin≤corner⇒ [] ⇑self inVector].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s &larr; (Vector new: 4) asStream.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[r origin y&gt;origin y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s next &larr; origin rect: corner x⌾(yorg &larr; r origin y)]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> yorg &larr; origin y].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[r corner y&lt;corner y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s next &larr; origin x⌾(ycor &larr; r corner y) rect: corner]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> ycor &larr; corner y].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[r origin x&gt;origin x⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s next &larr; origin x⌾yorg rect: r origin x⌾ycor]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[r corner x&lt;corner x⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s next &larr; r corner x⌾yorg rect: corner x⌾ycor]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑s contents]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">nearest: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑((origin x max: pt x) min: corner x) ⌾<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">((origin y max: pt y) min: corner y)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">side: side distanceTo: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[side<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=0⇒ [⇑pt y-origin y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒ [⇑pt x-origin x];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒ [⇑corner y-pt y];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒ [⇑corner x-pt x].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user notify: &rsquo;Invalid side&rsquo;]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">sideNearest: pt </span><span style="font: 10pt serif">| d dmin i imin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dmin &larr; 077777.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: (0 to: 3) do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dmin&gt;(d &larr; self side: i distanceTo: pt) abs⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dmin &larr; d.  imin &larr; i]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑imin]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Altering</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">dragto: dest </span><span style="font: 10pt serif">| v i<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self blt: dest mode: storing.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">v &larr; dest rect: dest+self extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i from: (self minus: v) do⦂ [i clear].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; dest. corner &larr; v corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">growby: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[corner &larr; corner + pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">growto: corner </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">maxstretch: bound </span><span style="font: 10pt serif">| bx by boundr selfr<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[bx&larr;(bound corner-origin) x. by&larr;(bound corner-origin) y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">boundr&larr;bx asFloat/by. selfr&larr;self width asFloat/self height.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selfr&gt;boundr⇒[self extent&larr;(bx⌾(bx asFloat/selfr) asInteger)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self extent&larr;((by asFloat*selfr) asInteger⌾by)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">moveby: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[origin &larr; origin+pt. corner &larr; corner+pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">moveto: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[corner &larr; corner+pt-origin. origin&larr;pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">translate: pt<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[origin &larr; origin+pt. corner &larr; corner+pt]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">translateto: pt <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self translate:  pt - origin. ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">usermove <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self usermove: user screenrect]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">usermove: bound </span><span style="font: 10pt serif">| m lim<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[lim&larr;bound corner-self extent. self bordercomp. m&larr;user mp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ true do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[[user redbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self bordercomp; moveto: (bound origin max: ((m&larr;user mp) min: lim)); bordercomp]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ (user anybug and⦂ m=user mp) do⦂ [].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user bluebug⇒[user waitnobug. ⇑self bordercomp]]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">usersize <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self usersize: user screenrect]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">usersize: bound </span><span style="font: 10pt serif">| m lim<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[[self origin≡nil⇒[origin&larr;user mp. self extent&larr;16]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self bordercomp. m&larr;user mp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ true do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[lim&larr;bound corner-self extent.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user redbug⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self bordercomp; moveto: (bound origin max: ((m&larr;user mp) min: lim)); bordercomp]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user yellowbug⇒[self bordercomp.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">corner&larr;m&larr;(user mp min: bound corner) max: origin. self bordercomp]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ (user anybug and⦂ m=user mp) do⦂ [].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user bluebug⇒[user waitnobug. ⇑self bordercomp]]]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Conversion</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asRectangle<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Return self."</span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asRectCorner<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑corner ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">asRectOrigin<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑origin ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsFromStream: strm </span><span style="font: 10pt serif">| rec s [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rec &larr; origin rect: origin + (self width ⌾ (16 min: self height)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s&larr; String new: rec bitStringLength.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ rec maxY ≤ corner y do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[strm into: s.  rec bitsFromString: s; moveby: 0⌾16].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rec minY &lt; corner y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rec corner y&larr; corner y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">s&larr; nil. s&larr; String new: rec bitStringLength.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm into: s.  rec bitsFromString: s]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsFromString: str<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"default stores bits onto display"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self bitsFromString: str mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsFromString: str mode: mode </span><span style="font: 10pt serif">[user croak] primitive: 52</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsFromString: str mode: mode clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| destRect <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">Load the screen bits within my area from those stored in </span><span style="font: italic 10pt serif; text-decoration: underline">str</span><span style="font: italic 10pt serif">.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">If </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: italic 10pt serif"> is not nil, then load only those bits within both<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">myself and </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self bitStringLength≠str length⇒[user notify: &rsquo;wrong bit string length&rsquo;]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">destRect&larr;self intersect: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil≡clipRect⇒[] destRect&larr;destRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BitBlt init destbase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">destraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dest&larr;destRect origin;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent&larr;destRect extent;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourceraster&larr;corner x-origin x+15/16;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">source&larr;destRect origin-origin;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourcebase &larr; str ; copy: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsIntoString </span><span style="font: 10pt serif">| str [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">str &larr; String new: self bitStringLength.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self  bitsIntoString: str mode: storing.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑str]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsIntoString: str<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"default stores bits into the string"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self bitsIntoString: str mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsIntoString: str mode: mode </span><span style="font: 10pt serif">[user croak] primitive: 51</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsIntoString: str mode: mode clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| sourceRect <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">Store the screen bits within my area into </span><span style="font: italic 10pt serif; text-decoration: underline">str</span><span style="font: italic 10pt serif">.  If </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: italic 10pt serif"> is not nil,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">then store only those bits within both myself and </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: italic 10pt serif">,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">leaving alone the other bits in </span><span style="font: italic 10pt serif; text-decoration: underline">str</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self bitStringLength≠str length⇒[user notify: &rsquo;wrong bit string length&rsquo;]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourceRect&larr;self intersect: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[clipRect≡nil⇒[] sourceRect&larr;sourceRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BitBlt init destraster&larr;corner x-origin x+15/16;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dest&larr;sourceRect origin-origin;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent&larr;sourceRect extent;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourcebase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourceraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">source&larr;sourceRect origin;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">destbase &larr; str ; copy: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitsOntoStream: strm </span><span style="font: 10pt serif">| rec s [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rec &larr; origin rect: origin + (self width ⌾ (16 min: self height)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s&larr; (String new: rec bitStringLength) all&larr;0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ rec maxY ≤ corner y do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rec bitsIntoString: s; moveby: 0⌾16.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">strm append: s].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">rec minY &lt; corner y⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[rec bitsIntoString: s.  strm append:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">s◦(1 to: s length/rec height*(corner y-rec minY))]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bitStringLength </span><span style="font: 10pt serif">| extent [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent &larr; corner - origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ 2 * extent y* (extent x +15/16)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hardcopy: pf </span><span style="font: 10pt serif">[self hardcopy: pf thickness: 2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hardcopy: pf thickness: th </span><span style="font: 10pt serif">| r [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ r from: ((self inset: 0-th) minus: self) do⦂ [pf showrect: r color: 0]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">printon: strm <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[strm print: origin; append: &rsquo; rect: &rsquo;; print: corner]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Image</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blowup: at by: scale </span><span style="font: 10pt serif">| z dest<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dest &larr; Rectangle new origin: at extent: self extent*scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(dest has: origin) or: (dest has: corner) ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[z &larr; self bitsIntoString. dest outline.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self moveto: dest origin. self bitsFromString: z]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dest outline].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self blowup: at by: scale spacing: 1]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blowup: at by: scale spacing: spacing<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| extent z inc sinc slice width height dest i j spread<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[extent &larr; self extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">scale &larr; scale asPoint.  spacing &larr; spacing asPoint.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dest &larr; Rectangle new origin: at extent: extent*scale.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">z &larr; 1⌾0. width &larr; extent x. height &larr;  0⌾extent y.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">spread &larr; (scale-spacing) x.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: 2 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"first do horiz, then vert"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[inc &larr; z * ¬1. sinc &larr; z * scale.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">slice &larr; Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin: (z * width) + [i = 1 ⇒[self origin] at]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: z + height.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dest &larr; at + (z * (scale * width)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ j to: width do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"slice it up"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[dest &larr; dest - sinc.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">slice moveby: inc.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">slice blt: dest mode: storing]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">slice &larr; Rectangle new origin: at + z<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: height+(z*(scale-1)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ j to: width do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"clear slice source"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[slice clear: white. slice moveby: sinc]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">slice &larr; Rectangle new origin: at<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent: height + (z * ((scale*width)-1)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ j to: spread - 1 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"spread it out"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[slice blt: at + z mode: oring]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">z &larr; 0⌾1.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"flip to do vertical"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">width &larr; extent y. height &larr; (scale*extent) x⌾0.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">spread &larr; (scale-spacing) y]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blt: dest mode: mode </span><span style="font: 10pt serif">[user croak] primitive: 47</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">blt: dest mode: mode clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| destRect clippedSource<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">Copy the screen bits within my area to the rectangle whose<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">origin is </span><span style="font: italic 10pt serif; text-decoration: underline">dest</span><span style="font: italic 10pt serif"> and whose extent is the same as mine.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">If </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: italic 10pt serif"> is not nil, then copy only those bits within both<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">the destination rectangle and </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">destRect&larr;(Rectangle new origin: dest extent: self extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">intersect: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil≡clipRect⇒[] destRect&larr;destRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">find the source for the bits after clipping</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">clippedSource&larr;origin+destRect origin-dest.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BitBlt init<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">destbase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">destraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dest&larr;destRect origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent&larr;destRect extent;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourcebase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourceraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">source&larr;clippedSource;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">copy: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">bltcomp: dest mode: mode </span><span style="font: 10pt serif">[user croak] primitive: 48</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">brush: dest mode: mode color: color </span><span style="font: 10pt serif">[user croak] primitive: 49</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">brush: dest mode: mode color: color clippedBy: clipRect<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| destRect clippedSource<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["</span><span style="font: italic 10pt serif">Brush the screen bits within my area to the rectangle whose<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">origin is </span><span style="font: italic 10pt serif; text-decoration: underline">dest</span><span style="font: italic 10pt serif"> and whose extent is the same as mine.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">If </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: italic 10pt serif"> is not nil, then brush only those bits within both<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">the destination rectangle and </span><span style="font: italic 10pt serif; text-decoration: underline">clipRect</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">destRect&larr;(Rectangle new origin: dest extent: self extent)<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">intersect: user screenrect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil≡clipRect⇒[] destRect&larr;destRect intersect: clipRect].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">find the source for the bits after clipping</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">clippedSource&larr;origin+destRect origin-dest.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">BitBlt init<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">color&larr;color;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">destbase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">destraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">dest&larr;destRect origin;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">extent&larr;destRect extent;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourcebase&larr;mem◦066;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">sourceraster&larr;user screenrect width/16|2;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">source&larr;clippedSource;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">paint: mode]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">clear</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"default is backround"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self color: background mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">clear: color<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self color: color mode: storing]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">color: color mode: mode </span><span style="font: 10pt serif">[user croak] primitive: 50</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">comp<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self color: black mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">comp: color<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self color: color mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fillin: color mode: mode </span><span style="font: 10pt serif">| T bits p s dirs i which</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"Rectangle new fromuser fillin: gray"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[T &larr; Turtle init.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p&larr; origin + (self width⌾0).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s&larr; Rectangle new origin: p extent: self extent.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">dirs&larr;((1⌾0), (¬1⌾0), (0⌾1), (0⌾¬1)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bits&larr; s bitsIntoString.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self blt: p mode: storing.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"s &larr; self"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug. T place: user mp; pendn.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user anybug do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"draw seed in self"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[T goto: user mp].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self blt: p mode: xoring.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"s &larr; seed only"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s blt: origin mode: xoring.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"take seed out of self"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ user anybug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[for⦂ which from: 0 to: 2 by: 2 do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: 2 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[s blt: dirs◦(which+i)+p mode: oring]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"smear seed around"<br> </span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self blt: p mode: erasing]]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"then clip to outline"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s brush: origin mode: mode color: color.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"paint it in"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">s bitsFromString: bits]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"restore background to s"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">flash </span><span style="font: 10pt serif">[self comp; comp]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">reverse<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self color: black mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rotate</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"(0⌾0 rect: 128⌾128) rotate."<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">| size maskr spt mpt tpt data temp atab btab i unit<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[size &larr; self extent x. spt &larr; size⌾size.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"size must be a power of 2"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">data &larr; Rectangle new origin: origin extent: spt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr &larr; Rectangle new origin: (mpt&larr; origin + (0⌾size)) extent: spt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">temp &larr; Rectangle new origin: (tpt&larr; mpt + (size⌾0)) extent: spt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">atab &larr; (0⌾0),(1⌾0),(0⌾0),(0⌾1),(1⌾1),(0⌾1),(1⌾0),(¬1⌾0),(1⌾0).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">btab &larr; (0⌾0),(1⌾1),(0⌾0),(1⌾1),(¬1⌾¬1),(1⌾1).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">unit &larr; size/2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr clear: white.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(Rectangle new origin: mpt extent: unit⌾unit) clear: black.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ unit&lt;1 do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[for⦂ i to: 3 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"flip left and right halves"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[temp clear: white.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr blt: atab◦i*unit + tpt mode: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr blt: atab◦(3+i)*unit + tpt mode: oring.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">data bltcomp: tpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">temp blt: atab◦(6+i)*unit + origin mode: xoring].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">for⦂ i to: 3 do⦂</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"flip diagonals"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[temp clear: white.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr blt: btab◦i*unit + tpt mode: storing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">data bltcomp: tpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">temp blt: btab◦(3+i)*unit + origin mode: xoring].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">(unit&larr; unit/2)&lt;1⇒[]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr blt: (0⌾unit)+mpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr blt: (unit⌾0)+mpt mode: erasing.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr blt: (unit*2⌾0)+mpt mode: oring.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">maskr blt: (0⌾(2*unit))+mpt mode: oring]]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>Border</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">border: thick color: color</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"paints a border withoud disturbing interior"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin: origin-(thick⌾thick) corner: (corner x+thick)⌾origin y)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">clear: color;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">moveto: (origin x-thick)⌾corner y; clear: color;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; corner x⌾(origin y-thick); clear: color;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">moveto: origin-(thick⌾thick); clear: color]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">boxcomp</span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"paints a border withoud disturbing interior"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[(Rectangle new<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin: origin-(2⌾2) corner: (corner x+2)⌾origin y)<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">color: black mode: xoring;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">moveto: (origin x-2)⌾corner y; color: black mode: xoring;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">origin &larr; corner x⌾(origin y-2); color: black mode: xoring;<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">moveto: origin-(2⌾2); color: black mode: xoring]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">outline </span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"default border is two thick"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self outline: 2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">outline: thick </span><span style="font: 10pt serif">| t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[t &larr; (¬1⌾¬1)*thick.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(self inset: t) clear: black.  self clear: white]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif"></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: 10pt serif">SystemOrganization classify: ↪Rectangle under: &rsquo;Form Path Image&rsquo;.</span></div>
<div style="width: 141pt; margin-left: 425pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>"TextImage"</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif">Class new title: &rsquo;TextImage&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">subclassof: Textframe<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">fields: &rsquo;c1 c2 begintypein superimage figure ground&rsquo;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">declare: &rsquo;cut esc paste aurora Scrap scrap bs Deletion aurorarunning paragraphmenu ctlw &rsquo;;<br></span><span class="tab" val="79"></span><span style="font: bold 12pt serif">asFollows</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: italic 10pt serif"><br>This class has not yet been commented</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>INIT</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">classInit <br></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">bs &larr; 8. ctlw &larr; 145. esc &larr; 160. cut &larr; 173. paste &larr; 158.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Scrap &larr; Deletion &larr; nullString.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">paragraphmenu &larr; Menu new string:<br>&rsquo;resize<br>fit<br>cut<br>paste<br>copy<br>align<br>figure<br>ground<br>&rsquo;.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurora &larr; "Aurora new" nil.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurorarunning &larr; false.<br>]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">close<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[superimage&larr;nil]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">paragraph: para frame: frame style: style<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self paragraph: para frame: frame style: style figure: 1 ground: 0<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">paragraph: para frame: frame style: style figure: figure ground: ground<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[nil≡ para ⇒ [ para &larr; nullString ]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c1 &larr; c2 &larr; begintypein&larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self para: para frame: frame style: style<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">text: t width: w | run r<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c1 &larr; c2 &larr; begintypein&larr; 1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">run &larr; String new: 2. run word: 1 &larr;  16 * 7 + 0177400.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">r &larr; Rectangle new origin: 0⌾0 extent: w⌾(DefaultTextStyle lineheight+2).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self paragraph: (Paragraph new text: t runs: run  alignment: 2) frame: r style: DefaultTextStyle.<br><br> ]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>EDITING</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">align<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[para alignment &larr; ↪(1 2 4 0 0)◦(1+para alignment).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reversefrom: c1 to: c2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">checklooks </span><span style="font: 10pt serif">| t val mask [<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"see ParagraphEditor checklooks.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">substitute c1 for loc1, c2 for loc2, oldEntity for oldpara, entity for para"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; ↪(166 150 137 151   230 214 201 215<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">135 159 144 143 128 127 129 131 180 149<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">199 223 208 207 192 191 240 226) find: user kbck.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t=0⇒[⇑false]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user kbd.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t=25⇒[self toBravo]; "ctl-T" <br></span><span class="tab" val="79"></span><span style="font: 10pt serif"> =26⇒[self fromBravo]. "ctl-F" <br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"[oldEntity⇒[] oldEntity &larr; entity recopy]."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">val &larr; ↪(1 2 4 256   ¬1 ¬2 ¬4 256  "ctl-b i - x   B I ¬ X"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">0 16 32 48 64 80 96 112 128 144  "ctl-0 1 ... 9"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">160 176 192 208 224 240)◦t.  "ctl-shift-0 1 ... 5"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[val=256⇒[mask&larr; 0377.  val&larr; 0]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"reset all"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">val&lt;0⇒[mask&larr; 0-val.  val&larr; 0]</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"reset emphasis"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">val&gt;0 and⦂ val&lt;16⇒[mask&larr; val]</span><span class="tab" val="79"></span><span style="font: 10pt serif">"set emphasis"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">mask&larr; 0360].</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"set font"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para maskrun: c1 to: c2-1 under: mask to: val]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copyselection <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["copy the current selection and store it in the Scrap."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Scrap &larr; para copy: c1 to: c2-1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">cut <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["cut out the current selection and redisplay the paragraph."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Scrap &larr; para copy: c1 to: c2-1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span style="font: 10pt serif">"deselect old selection"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para replace: c1 to: c2-1 by: nullString.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c2 &larr; c1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">begintypein &larr; false.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span style="font: 10pt serif">"show new selection"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">edit: superimage </span><span style="font: 10pt serif">| pt charindex<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"eventually a general paragraph manipulator for now just a hack."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show ; reversefrom: c1 to: c2." show current selection"user waitnobug.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ 1=2 do⦂ "forever for now"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user kbck⇒ [self kbd]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user yellowbug⇒ [paragraphmenu bug<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=1⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self resize ]; "resize"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=2⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self fit]; "include all of the text in the current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=3⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self cut]; "delete the current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=4⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self paste]; "paste the Scrap over the selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=5⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self copyselection]; "copy current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=6⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self align]; "change the alignment of the paragraph"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=7⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self setfigure]; "set color corrisponding to 1"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=8⇒</span><span class="tab" val="79"></span><span style="font: 10pt serif">[self setground] "set color corrisponding to 1"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user redbug⇒ [self reversefrom: c1 to: c2. frame has: (pt &larr; user mp)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self select: pt]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self.]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user tabletbug⇒ [frame has: (pt &larr; user mp)⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self tabletBug]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reversefrom: c1 to: c2. ⇑self.]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">user bluebug⇒ [self reversefrom: c1 to: c2. "erase current selection"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self.] "and exit back to the document"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fintype<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[begintypein⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span class="tab" val="79"></span><span style="font: 10pt serif">[begintypein&lt;c1⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[Scrap &larr; para copy: begintypein to: c1-1.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c1 &larr; begintypein]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">begintypein &larr; false]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑false]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fit</span><span style="font: 10pt serif">| t <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"make the bounding rectangle of the TextImage contain all the textwhile not changing the width of the TextImage."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self white.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame extent&larr; ((frame width)⌾ 1000).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr; self rectofchar: (para length+1).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame extent&larr; (frame width)⌾((t corner y) - (frame origin y)).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show. frame border: 1 color: ¬1. self reversefrom: c1 to: c2.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">kbd </span><span style="font: 10pt serif">| more char  "key struck on the keyboard"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[c1&lt;c2 and⦂ self checklooks⇒[⇑ self show reversefrom: c1 to: c2]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">more &larr; Set new string: 16.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[begintypein⇒[] Deletion &larr; para copy: c1 to: c2-1. begintypein &larr; c1].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ (char &larr; user kbdnext) do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">char<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=bs⇒ ["backspace"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">more empty⇒ [begintypein &larr; begintypein min: (c1 &larr; 1 max: c1-1)]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">more skip: ¬1];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=cut⇒ [⇑self cut];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=paste⇒ [⇑self paste];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=ctlw⇒ ["ctl-w for backspace word"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">more reset.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c1 &larr; 1 max: c1-1.</span><span class="tab" val="79"></span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ [c1&gt;1 and⦂ (para◦(c1-1)) tokenish] do⦂ [c1 &larr; c1-1].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">begintypein &larr; begintypein min: c1];<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">=esc⇒ ["</span><span style="font: italic 10pt serif">select previous type-in</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[more empty⇒[self reversefrom: c1 to: c2]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">para replace: c1 to: c2-1 by:  more. c1 &larr; c2].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fintype.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c1 &larr; c2-Scrap length.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑self reversefrom: c1 to: c2]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">"just a normal character"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">more next&larr; char].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">para replace: c1 to: c2-1 by:  more. c2 &larr; c1 + more length. c1 &larr; c2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show. self reversefrom: c1 to: c2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">paste <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["paste the Scrap over the current selection and redisplay the paragraph."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self fintype.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span style="font: 10pt serif">"deselect current selection"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para replace: c1 to: c2-1 by: Scrap.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c2 &larr; c1 + Scrap length.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self reversefrom: c1 to: c2.</span><span class="tab" val="79"></span><span style="font: 10pt serif">"highlight new selection"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">resize </span><span style="font: 10pt serif">| t pt xgrid ygrid<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"Show the origin cursor until the user presses a mouse button,<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">then get my origin"<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"Show the corner cursor and show me until  user nobug<br></span><span class="tab" val="79"></span><span style="font: italic 10pt serif">"</span><span style="font: 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t&larr;frame origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">CornerCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">user waitbug. self white.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame corner&larr; frame origin.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">until⦂ user nobug do⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[self white.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">( pt &larr; <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((superimage superimage) mp)+<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">((superimage superimage) rectangle origin)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">frame corner&larr; pt max: frame origin+ (16⌾(style lineheight)).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self displayat: frame origin effect: 0 clippedBy: frame.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">NormalCursor topage1.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self show. frame boxcomp. self reversefrom: c1 to: c2.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">setfigure </span><span style="font: 10pt serif">| <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"for now just increment the figure color by 1 \ 14"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure &larr; (figure +1 ) \ 14.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self displayat: (self frame origin) effect: 0 clippedBy: user screenrect.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">setground </span><span style="font: 10pt serif">| <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[</span><span style="font: italic 10pt serif">"for now just increment the figure color by 1 \ 14"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">ground &larr; (ground +1 ) \ 14.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self displayat: (self frame origin) effect: 0 clippedBy: user screenrect.<br>]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">white <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["white out the image"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(frame inset: (¬2⌾¬2)) clear: 0.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SELECTION</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">complementfrom: hair1 to: hair2 </span><span style="font: 10pt serif">| temprect<br>["Complement the screen dots corresponding to the lines and part-lines of the paragraph between hair1 inclusive and hair2 exclusive.  If hair1 = hair2, this is a no-op.  If hair1 &gt; hair2, they are reversed. This complementing happens in three parts, A, B, and C, between points 1 and 2, according to the following illustration:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">1AAA<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">BBBB<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">BBBB<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">BBBB<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">CCC2<br>unless there is just one line involved, as in:<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">1DD2<br>"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"one line case"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">hair1 minY = hair2 minY⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[((([hair1 minX ≤ hair2 minX⇒ [hair1 origin rect: hair2 corner]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">hair2 origin rect: hair1 corner]) intersect: frame) intersect: window) comp]<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[hair1 minY &gt; hair2 minY⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">temprect &larr; hair1. hair1 &larr; hair2. hair2 &larr; temprect]].<br><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">temprect &larr; (frame minX ⌾ hair1 maxY) rect: (frame maxX ⌾ hair2 minY).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">(((hair1 origin rect: (temprect maxX ⌾ temprect minY)) intersect: frame) intersect: window)  comp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">((temprect intersect: frame) intersect: window)  comp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">((((temprect minX ⌾ temprect maxY) rect: hair2 corner) intersect: frame) intersect: window)  comp.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">reversefrom: char1 to: char2</span><span style="font: 10pt serif">| h1 h2<br>["Complement the dots corresponding to the the lines and part-lines of the paragraph between the left edge of char1 and the left edge of char2.  If char1 = char2, this is sort of a no-op.  If char1 &gt; char2, this is undefined."<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self ptofchar: char1. h1 &larr; reply1 rect: reply2.<br> </span><span class="tab" val="79"></span><span style="font: 10pt serif">[char2=char1⇒[h2 &larr; h1+ (1⌾0)] self ptofchar: char2. h2 &larr; reply1 rect: reply2.].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self complementfrom: h1 to: h2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">select: pt </span><span style="font: 10pt serif">| h1 h2 c h drag2 selection<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"draw out and record ( c1 and c2) a selection"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">c1 &larr; c2 &larr; self charofpt: pt.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">h1 &larr; reply1 rect: reply2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">h2 &larr; h1 + (1⌾0).<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self complementfrom: h1 to: h2.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">selection &larr; true.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">while⦂ (pt &larr; user mpnext) do⦂ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c &larr; self charofpt: pt.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">h &larr; "proj screenHairBeforeThatChar" reply1 rect: reply2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[c1 = c2⇒ [drag2 &larr; c ≥ c2]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[drag2⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[c &lt; c1⇒ [h &larr; self ptofchar: (c &larr; c1). h &larr; reply1 rect: reply2.]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self complementfrom: h to: h2.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c2 &larr; c. h2 &larr; h]<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[c &gt; c2⇒ [h &larr; self ptofchar: (c &larr; c2). h &larr; reply1 rect: reply2.]].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self complementfrom: h1 to: h.</span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">c1 &larr; c. h1 &larr; h].<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">h1 = h2⇒ [<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">self complementfrom: h1 to: (h2 &larr; h1 + (1⌾0))]].<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">drag2⇒ []<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"get rid of extra line in backwards select"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self complementfrom: h2 - (1⌾0) to: h2]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>SYSTEM</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">copy | t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t &larr;  TextImage new paragraph: para copy frame: (frame copy) style: style copy.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">t c1&larr; c1 ; c2&larr; c2 ; begintypein &larr; begintypein.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ t<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">fromPress: press value: s </span><span style="font: 10pt serif">[</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">"</span><span style="font: italic 10pt serif">frame set by Image</span><span style="font: 10pt serif">"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">para &larr; Paragraph new fromPress: press value: s.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure &larr; s nextword.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">self paragraph: para frame: frame style: DefaultTextStyle<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">figure: figure ground: s nextword]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hideData: complete </span><span style="font: 10pt serif">| s p [ <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">p &larr; para hideData: complete.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">Stream new of: (s &larr; String new: p length+4);<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">append: p;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; figure;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">nextword &larr; ground.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑s]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">hidePress: press complete: c </span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">press skipcode: self pressCode data: (self hideData: c)]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">pressCode </span><span style="font: 10pt serif">[⇑4]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">presson: press in: r <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ para presson: press in: r.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">show | </span><span style="font: 10pt serif">lastvisible</span><span style="font: bold 10pt serif"><br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["display text and expand the frame in y to include all of<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">the text if the textimage is too small"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super show.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">lastvisible &larr; self rectofchar: para length.</span><span class="tab" val="79"></span><span style="font: 10pt serif">"see if lastvisible out of frame"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">lastvisible bottom &gt; frame bottom ⇒<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[frame corner y&larr; lastvisible corner y.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">super show.<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">]<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>ACCESS TO PARTS</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">begintypein&larr; begintypein </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">c1&larr; c1 </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">c2&larr; c2 </span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">figure <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the figure color (color associated with black) for this TextImage"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ figure<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">figure: figure <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["change the figure color (color associated with black) for this TextImage"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ground <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["return the ground color (color associated with white) for this TextImage"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑ ground<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">ground: ground <br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["change the ground color (color associated with white) for this TextImage"]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">leftflush<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[ (self para) flushleft]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">rectangle<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["Return rectangle (frame of Textframe) for compatibility with Image calls -- <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">needed in findbyrect: in Document"<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">⇑frame]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">text<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">[⇑ self para text]</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 12pt serif"><br>DISPLAY</span></div>
<div style="width: 442pt; margin-left: 84pt; margin-top: 0pt; text-align: left">
<span style="font: bold 10pt serif">displayat: pt effect: effect clippedBy: cliprect | clippedrect<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">["display text "<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">super displayat: pt effect: effect clippedBy: cliprect.<br></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurorarunning⇒ <br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[user displayoffwhile⦂<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">[clippedrect &larr; (super frame) intersect: (user screenrect).<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span style="font: 10pt serif">aurora destination: clippedrect ; source: clippedrect ;<br></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" val="79"></span><span class="tab" v